================================================================================
Risk Manager V34 - Test Report
================================================================================
Test Run: GATE: Unit tests
Timestamp: 2025-10-27 23:21:25
Status: FAILED
Exit Code: 1
================================================================================

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0 -- /mnt/c/Users/jakers/Desktop/risk-manager-v34/.venv/bin/python
cachedir: .pytest_cache
rootdir: /mnt/c/Users/jakers/Desktop/risk-manager-v34
configfile: pyproject.toml
plugins: anyio-4.11.0, asyncio-1.2.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
[1mcollecting ... [0mcollected 501 items

tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_load_from_env_variables [32mPASSED[0m[33m [  0%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variables_override_defaults [32mPASSED[0m[33m [  0%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_explicit_params_override_env [32mPASSED[0m[33m [  0%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_partial_env_variables [32mPASSED[0m[33m [  0%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_case_insensitive [32mPASSED[0m[33m [  0%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_with_prefix [32mPASSED[0m[33m [  1%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_boolean_env_variables [32mPASSED[0m[33m [  1%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_integer_env_variables [32mPASSED[0m[33m [  1%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_float_env_variables [32mPASSED[0m[33m [  1%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_optional_env_variables [32mPASSED[0m[33m [  1%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_missing_optional_env_variables [32mPASSED[0m[33m [  2%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_file_loading [31mFAILED[0m[31m [  2%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variables_override_env_file [31mFAILED[0m[31m [  2%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_empty_env_variable [32mPASSED[0m[31m [  2%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_whitespace_env_variable [32mPASSED[0m[31m [  2%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_with_special_characters [32mPASSED[0m[31m [  3%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_multiline_env_variable [32mPASSED[0m[31m [  3%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_validation_alias [32mPASSED[0m[31m [  3%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_url_env_variables [32mPASSED[0m[31m [  3%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_all_fields_from_env [32mPASSED[0m[31m [  3%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_type_coercion_errors [32mPASSED[0m[31m [  4%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_missing_required_env_variable [32mPASSED[0m[31m [  4%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_file_with_comments [31mFAILED[0m[31m [  4%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_file_with_quotes [31mFAILED[0m[31m [  4%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_file_with_equals_in_value [32mPASSED[0m[31m [  4%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_file_missing [32mPASSED[0m[31m [  5%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_combined_yaml_and_env [32mPASSED[0m[31m [  5%][0m
tests/unit/test_config/test_env_substitution.py::TestEnvironmentVariableSubstitution::test_env_variable_unicode [32mPASSED[0m[31m [  5%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_valid_yaml_file [32mPASSED[0m[31m [  5%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_all_fields [32mPASSED[0m[31m [  5%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_minimal_required_only [32mPASSED[0m[31m [  6%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_missing_required_field [32mPASSED[0m[31m [  6%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_nonexistent_file [32mPASSED[0m[31m [  6%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_empty_yaml_file [32mPASSED[0m[31m [  6%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_null_values [32mPASSED[0m[31m [  6%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_comments [32mPASSED[0m[31m [  7%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_extra_fields [32mPASSED[0m[31m [  7%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_nested_structure [32mPASSED[0m[31m [  7%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_boolean_strings [32mPASSED[0m[31m [  7%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_numeric_strings [32mPASSED[0m[31m [  7%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_invalid_yaml_syntax [32mPASSED[0m[31m [  8%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_duplicate_keys [32mPASSED[0m[31m [  8%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_from_string_path [32mPASSED[0m[31m [  8%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_from_pathlib_path [32mPASSED[0m[31m [  8%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_list_values [32mPASSED[0m[31m [  8%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_scientific_notation [32mPASSED[0m[31m [  9%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_multiline_strings [32mPASSED[0m[31m [  9%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_preserves_field_types [32mPASSED[0m[31m [  9%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_special_characters_in_strings [32mPASSED[0m[31m [  9%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_with_unicode_characters [32mPASSED[0m[31m [  9%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_file_permission_error [32mPASSED[0m[31m [ 10%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_relative_path [32mPASSED[0m[31m [ 10%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_load_yaml_absolute_path [32mPASSED[0m[31m [ 10%][0m
tests/unit/test_config/test_loader.py::TestConfigLoader::test_to_dict_roundtrip [32mPASSED[0m[31m [ 10%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_valid_config_minimal [32mPASSED[0m[31m [ 10%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_valid_config_all_fields [32mPASSED[0m[31m [ 11%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_missing_required_field_api_key [32mPASSED[0m[31m [ 11%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_missing_required_field_username [32mPASSED[0m[31m [ 11%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_missing_both_required_fields [32mPASSED[0m[31m [ 11%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_invalid_max_contracts_negative [32mPASSED[0m[31m [ 11%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_invalid_max_contracts_zero [32mPASSED[0m[31m [ 12%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_max_daily_loss_positive [32mPASSED[0m[31m [ 12%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_max_daily_loss_zero [32mPASSED[0m[31m [ 12%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_optional_fields_none [32mPASSED[0m[31m [ 12%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_log_level_valid_values [32mPASSED[0m[31m [ 12%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_log_level_case_insensitive [32mPASSED[0m[31m [ 13%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_boolean_fields_true [32mPASSED[0m[31m [ 13%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_boolean_fields_false [32mPASSED[0m[31m [ 13%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_integer_fields_valid [32mPASSED[0m[31m [ 13%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_float_fields_valid [32mPASSED[0m[31m [ 13%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_string_fields_empty [32mPASSED[0m[31m [ 14%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_extra_fields_ignored [32mPASSED[0m[31m [ 14%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_to_dict_method [32mPASSED[0m[31m [ 14%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_model_dump_includes_all_fields [32mPASSED[0m[31m [ 14%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_environment_field_values [32mPASSED[0m[31m [ 14%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_url_fields_format [32mPASSED[0m[31m [ 15%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_type_coercion_string_to_int [32mPASSED[0m[31m [ 15%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_type_coercion_string_to_float [32mPASSED[0m[31m [ 15%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_type_coercion_string_to_bool [32mPASSED[0m[31m [ 15%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_invalid_type_for_int_field [32mPASSED[0m[31m [ 15%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_invalid_type_for_float_field [32mPASSED[0m[31m [ 16%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_config_equality [32mPASSED[0m[31m [ 16%][0m
tests/unit/test_config/test_models.py::TestRiskConfigModel::test_config_immutability_after_creation [32mPASSED[0m[31m [ 16%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_positive_max_contracts_valid [32mPASSED[0m[31m [ 16%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_zero_max_contracts_valid [32mPASSED[0m[31m [ 16%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_negative_max_contracts_allowed [32mPASSED[0m[31m [ 17%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_negative_max_daily_loss_valid [32mPASSED[0m[31m [ 17%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_positive_max_daily_loss_allowed [32mPASSED[0m[31m [ 17%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_zero_max_daily_loss_valid [32mPASSED[0m[31m [ 17%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_positive_grace_seconds_valid [32mPASSED[0m[31m [ 17%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_zero_grace_seconds_valid [32mPASSED[0m[31m [ 18%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_negative_grace_seconds_allowed [32mPASSED[0m[31m [ 18%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_positive_latency_target_valid [32mPASSED[0m[31m [ 18%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_positive_max_events_valid [32mPASSED[0m[31m [ 18%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_empty_string_api_key_valid [32mPASSED[0m[31m [ 18%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_empty_string_username_valid [32mPASSED[0m[31m [ 19%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_whitespace_string_api_key_valid [32mPASSED[0m[31m [ 19%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_valid_log_levels [32mPASSED[0m[31m [ 19%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_lowercase_log_level_valid [32mPASSED[0m[31m [ 19%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_invalid_log_level_allowed [32mPASSED[0m[31m [ 19%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_valid_environment_values [32mPASSED[0m[31m [ 20%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_invalid_environment_allowed [32mPASSED[0m[31m [ 20%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_valid_url_formats [32mPASSED[0m[31m [ 20%][0m
tests/unit/test_config/test_validator.py::TestFieldValidation::test_invalid_url_format_allowed [32mPASSED[0m[31m [ 20%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_all_required_fields_present [32mPASSED[0m[31m [ 20%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_conflicting_ai_settings_allowed [32mPASSED[0m[31m [ 21%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_ai_features_without_enable_ai_allowed [32mPASSED[0m[31m [ 21%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_notifications_without_credentials_allowed [32mPASSED[0m[31m [ 21%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_debug_in_production_allowed [32mPASSED[0m[31m [ 21%][0m
tests/unit/test_config/test_validator.py::TestModelValidation::test_low_latency_with_high_events_allowed [32mPASSED[0m[31m [ 21%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_string_to_int_coercion [32mPASSED[0m[31m [ 22%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_string_to_float_coercion [32mPASSED[0m[31m [ 22%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_string_to_bool_coercion_true [32mPASSED[0m[31m [ 22%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_string_to_bool_coercion_false [32mPASSED[0m[31m [ 22%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_int_to_float_coercion [32mPASSED[0m[31m [ 22%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_float_to_int_coercion [32mPASSED[0m[31m [ 23%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_invalid_string_to_int_raises_error [32mPASSED[0m[31m [ 23%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_invalid_string_to_float_raises_error [32mPASSED[0m[31m [ 23%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_list_to_string_raises_error [32mPASSED[0m[31m [ 23%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_dict_to_string_raises_error [32mPASSED[0m[31m [ 23%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_none_for_required_field_raises_error [32mPASSED[0m[31m [ 24%][0m
tests/unit/test_config/test_validator.py::TestTypeValidation::test_none_for_optional_field_valid [32mPASSED[0m[31m [ 24%][0m
tests/unit/test_config/test_validator.py::TestErrorMessages::test_missing_required_field_error_message [32mPASSED[0m[31m [ 24%][0m
tests/unit/test_config/test_validator.py::TestErrorMessages::test_invalid_type_error_message [32mPASSED[0m[31m [ 24%][0m
tests/unit/test_config/test_validator.py::TestErrorMessages::test_multiple_errors_reported [32mPASSED[0m[31m [ 24%][0m
tests/unit/test_config/test_validator.py::TestErrorMessages::test_error_includes_field_location [32mPASSED[0m[31m [ 25%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_very_large_max_contracts [32mPASSED[0m[31m [ 25%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_very_large_loss_limit [32mPASSED[0m[31m [ 25%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_very_small_latency_target [32mPASSED[0m[31m [ 25%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_very_high_event_rate [32mPASSED[0m[31m [ 25%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_very_long_strings [32mPASSED[0m[31m [ 26%][0m
tests/unit/test_config/test_validator.py::TestEdgeCases::test_special_characters_in_all_string_fields [32mPASSED[0m[31m [ 26%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_engine_accepts_trading_integration [32mPASSED[0m[31m [ 26%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_flatten_all_calls_trading_integration [32mPASSED[0m[31m [ 26%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_flatten_all_without_trading_integration [32mPASSED[0m[31m [ 26%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_enforcement_from_violation [32mPASSED[0m[31m [ 27%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_create_event_bus [32mPASSED[0m[31m [ 27%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_subscribe_to_event [32mPASSED[0m[31m [ 27%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_subscribe_multiple_callbacks [32mPASSED[0m[31m [ 27%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_unsubscribe_from_event [32mPASSED[0m[31m [ 27%][0m
tests/unit/test_core/test_events.py::TestRiskEvent::test_create_event [32mPASSED[0m[31m [ 28%][0m
tests/unit/test_core/test_events.py::TestRiskEvent::test_event_has_timestamp [32mPASSED[0m[31m [ 28%][0m
tests/unit/test_core/test_events.py::TestEventType::test_event_types_exist [32mPASSED[0m[31m [ 28%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_rule_initialization [32mPASSED[0m[31m [ 28%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_rule_initialization_custom_settings [32mPASSED[0m[31m [ 28%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_disconnected_creates_alert [32mPASSED[0m[31m [ 29%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_disconnected_updates_connection_state [32mPASSED[0m[31m [ 29%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_disconnected_disabled_returns_none [32mPASSED[0m[31m [ 29%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_disconnected_no_account_id_returns_none [32mPASSED[0m[31m [ 29%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_connected_no_alert [32mPASSED[0m[31m [ 29%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_sdk_connected_updates_connection_state [32mPASSED[0m[31m [ 30%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_auth_failed_creates_alert [32mPASSED[0m[31m [ 30%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_auth_failed_disabled_returns_none [32mPASSED[0m[31m [ 30%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_auth_failed_no_account_id_returns_none [32mPASSED[0m[31m [ 30%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_auth_success_no_alert [32mPASSED[0m[31m [ 30%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_position_updated_ignored [32mPASSED[0m[31m [ 31%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_order_filled_ignored [32mPASSED[0m[31m [ 31%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_trade_executed_ignored [32mPASSED[0m[31m [ 31%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_get_connection_status_unknown_account [32mPASSED[0m[31m [ 31%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_get_connection_status_known_account [32mPASSED[0m[31m [ 31%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_get_last_alert_time_unknown_account [32mPASSED[0m[31m [ 32%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_last_alert_time_tracked [32mPASSED[0m[31m [ 32%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_multiple_accounts_independent [32mPASSED[0m[31m [ 32%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_one_account_reconnects [32mPASSED[0m[31m [ 32%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_enforce_does_nothing [32mPASSED[0m[31m [ 32%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_disconnect_alert_has_required_fields [32mPASSED[0m[31m [ 33%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_auth_failed_alert_has_required_fields [32mPASSED[0m[31m [ 33%][0m
tests/unit/test_rules/test_auth_loss_guard.py::TestAuthLossGuardRuleUnit::test_alert_timestamp_is_iso_format [32mPASSED[0m[31m [ 33%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization [32mPASSED[0m[31m [ 33%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_validates_thresholds [32mPASSED[0m[31m [ 33%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_validates_duration [32mPASSED[0m[31m [ 34%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_sorts_thresholds [32mPASSED[0m[31m [ 34%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_winning_trade_no_cooldown [32mPASSED[0m[31m [ 34%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_breakeven_trade_no_cooldown [32mPASSED[0m[31m [ 34%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_small_loss_below_threshold [32mPASSED[0m[31m [ 34%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_loss_at_threshold_triggers_cooldown [32mPASSED[0m[31m [ 35%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_loss_exceeds_threshold_triggers_cooldown [32mPASSED[0m[31m [ 35%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier1 [32mPASSED[0m[31m [ 35%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier2 [32mPASSED[0m[31m [ 35%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier3 [32mPASSED[0m[31m [ 35%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_selects_highest_tier [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_cooldown_starts_timer [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_cooldown_expires_unlocks_account [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_already_in_cooldown_skips_evaluation [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_half_turn_trade_ignored [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_only_evaluates_trade_executed_events [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_evaluates_position_closed_events [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_missing_account_id [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_missing_pnl_field [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_violation_message_clarity [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization_custom_limit [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization_validates_limit [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_below_limit_passes [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_profitable_day_passes [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_at_limit_passes [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_exceeds_limit_violates [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_large_loss_violates [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_violation_triggers_lockout [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_lockout_persists_until_reset [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_multi_symbol_loss_tracking [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_ignores_half_turn_trades [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_counts_only_closed_positions [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_approaching_limit_warning [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_disabled_when_locked [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_enforcement_action_correct [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_only_evaluates_pnl_events [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_evaluates_pnl_updated_event [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_zero_pnl [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_missing_pnl_data [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_violation_message_clarity [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization_custom_target [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization_validates_target [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_below_target_passes [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_losing_day_passes [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_at_target_violates [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_exceeds_target_violates [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_large_profit_violates [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_violation_triggers_lockout [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_lockout_persists_until_reset [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_multi_symbol_profit_tracking [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_ignores_half_turn_trades [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_counts_only_closed_positions [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_approaching_target_no_violation [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_disabled_when_locked [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_enforcement_action_correct [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_only_evaluates_pnl_events [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_evaluates_pnl_updated_event [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_zero_pnl [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_missing_pnl_data [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_violation_message_clarity [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_mixed_trades_reach_target [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_success_message_positive_tone [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_cannot_trigger_both_profit_and_loss [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_can_be_disabled [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_enforce_method_sets_lockout [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_reset_time_calculation [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_initialization [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_initialization_validates_negative_limit [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_within_limit_passes [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_zero_loss_passes [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_profit_does_not_trigger [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_at_exact_limit_violates [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_exceeds_limit_violates [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_short_position_loss_exceeds_limit [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_violation_targets_specific_position_only [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_violation_does_not_create_lockout [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_multi_symbol_independent_tracking [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_long_position_pnl_calculation [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_es_position_pnl_calculation [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_missing_market_price_returns_none [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_small_loss_within_limit [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_disabled_rule_does_not_trigger [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_name [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rty_symbol_tick_calculation [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_zero_size_position_returns_zero_pnl [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_rule_initialization [31mERROR[0m[31m [ 52%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_rule_initialization_custom_action [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_below_limit_passes [31mERROR[0m[31m [ 52%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_zero_position_passes [31mERROR[0m[31m [ 52%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_at_limit_passes [31mERROR[0m[31m [ 53%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_exceeds_limit_violates [31mERROR[0m[31m [ 53%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_large_position_violates [31mERROR[0m[31m [ 53%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_multi_symbol_total_below_limit [31mERROR[0m[31m [ 53%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_multi_symbol_total_exceeds_limit [31mERROR[0m[31m [ 53%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_short_position_below_limit [31mERROR[0m[31m [ 54%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_short_position_exceeds_limit [31mERROR[0m[31m [ 54%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_flatten_action_in_violation [31mERROR[0m[31m [ 54%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_reject_action_in_violation [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_only_evaluates_position_events [31mERROR[0m[31m [ 54%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_evaluates_order_filled_event [31mERROR[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_negative_limit_raises_error [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_zero_limit [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_missing_position_data [31mERROR[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_violation_message_clarity [31mERROR[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_rule_initialization [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_rule_initialization_validates_positive_target [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_below_target_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_zero_profit_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_at_exact_target_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_exceeds_target_violates [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_short_position_profit_exceeds_target [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_violation_targets_specific_position_only [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_violation_does_not_create_lockout [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_multi_symbol_independent_tracking [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_long_position_pnl_calculation [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_mnq_position_pnl_calculation [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_missing_market_price_returns_none [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_initialization [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_can_be_disabled [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_starts_grace_period_timer [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_with_zero_size_ignored [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_missing_contract_id_ignored [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_placed_cancels_grace_period [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_without_stop_price_ignored [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_non_stop_order_ignored [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_for_different_position_ignored [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_grace_period_expiry_closes_position [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_grace_period_expiry_with_actual_timer [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_closed_cancels_grace_period [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_multiple_positions_tracked_separately [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_disabled_no_timers_started [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_get_status [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_reopened_restarts_timer [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_enforcement_failure_logged [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_ignore_non_position_and_order_events [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization_with_custom_hours [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization_validates_time_format [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_disabled_when_config_disabled [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_converts_et_to_utc_correctly [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_handles_dst_transitions [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_inside_hours_passes [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_at_session_start_passes [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_just_before_session_end_passes [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_before_session_start_violates [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_after_session_end_violates [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_at_session_end_violates [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_on_saturday_violates [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_on_sunday_violates [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_weekend_blocking_can_be_disabled [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_violation_triggers_lockout_until_session_start [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_lockout_skips_weekends [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_enforcement_sets_lockout [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_handles_missing_account_id_gracefully [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_disabled_skips_evaluation [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_already_locked_account_skips_evaluation [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_violation_message_clarity [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_different_timezones_supported [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization_with_wildcards [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization_empty_list [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_allowed_symbol_passes [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_multiple_allowed_symbols_pass [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_blocked_symbol_violates [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_position_in_blocked_symbol_violates [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_all_blocked_symbols_violate [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_uppercase [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_lowercase [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_mixed_case [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_prefix_match [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_contains_match [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_no_match [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_case_insensitive [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_order_placed_event [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_ignores_irrelevant_events [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_no_lockout_on_violation [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_empty_blocked_list_allows_all [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_missing_symbol_in_event [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_none_symbol_in_event [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_disabled_rule_allows_all [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_violation_message_clarity [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_violation_includes_rule_name [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_multiple_exact_matches [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_mixed_exact_and_wildcard [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization_custom_limits [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization_validates_limits [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_within_minute_limit_passes [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_within_hour_limit_passes [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_first_trade_of_day_passes [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_at_minute_limit_passes [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_minute_limit_exceeded_violates [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_minute_limit_significantly_exceeded [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_hour_limit_exceeded_violates [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_session_limit_exceeded_violates [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_starts_cooldown_timer [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_different_cooldowns_for_different_breaches [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rolling_window_only_counts_recent_trades [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_old_trades_expire_from_window [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_multiple_accounts_tracked_independently [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_cooldown_auto_unlocks_via_timer [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_minute_limit_takes_priority [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_only_evaluates_trade_executed_events [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_evaluates_all_trade_types [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_missing_account_id [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_database_error_handled [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_zero_cooldown_duration [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_message_clarity [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_includes_countdown_info [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_disabled_skips_evaluation [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_initialization [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_initialization_with_partial_config [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_stop_loss_on_long_position_open [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_stop_loss_on_short_position_open [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_take_profit_on_long_position_open [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_take_profit_on_short_position_open [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_bracket_order_on_position_open [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_adjust_trailing_stop_on_profit [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_trailing_stop_not_adjusted_on_loss [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_no_stop_loss_when_disabled [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_independent_management_per_symbol [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_missing_symbol_returns_none [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_disabled_returns_none [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_stop_price_long [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_stop_price_short [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_target_price_long [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_target_price_short [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_set_lockout_locks_account [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_is_locked_out_returns_true_when_locked [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_is_locked_out_returns_false_when_not_locked [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_get_lockout_info_returns_details [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_get_lockout_info_returns_none_when_not_locked [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_clear_lockout_removes_lockout [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_set_cooldown_creates_timer [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_auto_expires_after_duration [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_remaining_time_decreases [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_cleared_cancels_timer [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_integrates_with_timer_manager [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_check_expired_lockouts_runs_every_second [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_expired_lockout_auto_cleared [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_background_task_stops_on_shutdown [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_multiple_accounts_locked_independently [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_lockout_affects_only_target_account [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_clear_lockout_affects_only_target_account [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_lockout_saved_to_database [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_lockout_deleted_from_database_on_clear [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_load_lockouts_populates_memory_state [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_expired_lockout_removed_from_database [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_database_schema_correct [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_lockout_until_past_time_immediately_expired [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_lockout_reason_persisted_correctly [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_double_lockout_overwrites_previous [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestEventRouterIntegration::test_locked_account_blocks_rule_processing [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestEventRouterIntegration::test_unlocked_account_allows_rule_processing [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestLockoutTypes::test_hard_lockout_type_stored_correctly [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestLockoutTypes::test_cooldown_type_stored_correctly [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestStartupShutdown::test_lockouts_restored_on_startup [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestStartupShutdown::test_shutdown_cancels_all_timers [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_tracker_initializes [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_get_daily_pnl_returns_zero_for_new_account [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_add_trade_pnl_updates_daily_total [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerPersistence::test_pnl_survives_restart [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerPersistence::test_multiple_accounts_tracked_independently [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_reset_clears_daily_pnl [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_different_dates_tracked_separately [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_increments [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_resets_with_pnl [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_handles_zero_pnl_trades [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_handles_large_pnl_values [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_get_all_account_pnls [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_schedule_daily_reset_creates_schedule [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_converts_et_to_utc [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_persists_to_database [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_clears_pnl_tracker [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_clears_lockout [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_does_not_trigger_twice_same_day [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_schedule_weekly_reset_creates_schedule [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_weekly_reset_triggers_on_monday [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_weekly_reset_clears_weekly_pnl [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_et_to_utc_conversion_standard_time [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_et_to_utc_conversion_daylight_time [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_dst_transition_handling [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabasePersistence::test_reset_log_saved_to_database [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabasePersistence::test_last_reset_time_loaded_from_database [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_background_task_checks_every_minute [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_reset_triggered_automatically_at_time [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_shutdown_stops_background_task [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_multiple_accounts_independent_schedules [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_reset_time_calculation_near_midnight [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_unscheduled_account_returns_none [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabaseSchema::test_reset_log_table_created [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestIntegration::test_reset_sequence_executes_in_order [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestIntegration::test_full_lifecycle_start_to_stop [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_timer_manager.py::test_start_timer_creates_timer [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_timer_manager.py::test_get_remaining_time_decreases [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_timer_removes_timer [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_expired_timer_executes_callback [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_expired_timer_auto_removed [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_multiple_timers_run_simultaneously [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_timers_expire_independently [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_specific_timer_preserves_others [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_receives_correct_context [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_exception_doesnt_crash_manager [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_executes_exactly_once [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_async_callback_supported [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_zero_duration_timer_executes_immediately [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_negative_duration_raises_error [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_timer_precision_within_tolerance [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_check_timers_runs_every_second [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_check_timers_stops_on_shutdown [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_get_remaining_time_nonexistent_timer_returns_zero [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_nonexistent_timer_no_error [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_duplicate_timer_name_overwrites_previous [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_has_timer_returns_false_for_nonexistent [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_start_timer_without_callback_raises_error [32mPASSED[0m[31m [100%][0m

==================================== ERRORS ====================================
[31m[1m______ ERROR at setup of TestMaxPositionRuleUnit.test_rule_initialization ______[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m__ ERROR at setup of TestMaxPositionRuleUnit.test_position_below_limit_passes __[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_____ ERROR at setup of TestMaxPositionRuleUnit.test_zero_position_passes ______[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m___ ERROR at setup of TestMaxPositionRuleUnit.test_position_at_limit_passes ____[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_position_exceeds_limit_violates _[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m____ ERROR at setup of TestMaxPositionRuleUnit.test_large_position_violates ____[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_multi_symbol_total_below_limit _[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_multi_symbol_total_exceeds_limit _[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m__ ERROR at setup of TestMaxPositionRuleUnit.test_short_position_below_limit ___[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_short_position_exceeds_limit __[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m__ ERROR at setup of TestMaxPositionRuleUnit.test_flatten_action_in_violation __[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_only_evaluates_position_events _[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_ ERROR at setup of TestMaxPositionRuleUnit.test_evaluates_order_filled_event __[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m_____ ERROR at setup of TestMaxPositionRuleUnit.test_missing_position_data _____[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[31m[1m___ ERROR at setup of TestMaxPositionRuleUnit.test_violation_message_clarity ___[0m
[1m[31mtests/unit/test_rules/test_max_position_rule.py[0m:30: in config
    [0m[94mreturn[39;49;00m RiskConfig(max_contracts=[94m2[39;49;00m)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/pydantic_settings/main.py[0m:193: in __init__
    [0m[96msuper[39;49;00m().[92m__init__[39;49;00m([90m[39;49;00m
[1m[31mE   pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskConfig[0m
[1m[31mE   project_x_api_key[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
[1m[31mE   project_x_username[0m
[1m[31mE     Field required [type=missing, input_value={'max_contracts': 2}, input_type=dict][0m
[1m[31mE       For further information visit https://errors.pydantic.dev/2.12/v/missing[0m
=================================== FAILURES ===================================
[31m[1m__________ TestEnvironmentVariableSubstitution.test_env_file_loading ___________[0m
[1m[31m/mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/unit/test_config/test_env_substitution.py[0m:172: in test_env_file_loading
    [0m[94massert[39;49;00m config.project_x_api_key == [33m"[39;49;00m[33mdotenv_key[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: assert 'tj5F5k0jDY2p...pNOz8W5n7s=\r' == 'dotenv_key'[0m
[1m[31mE     [0m
[1m[31mE     [0m[91m- dotenv_key[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [92m+ tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7s=[39;49;00m[90m[39;49;00m[0m
[31m[1m___ TestEnvironmentVariableSubstitution.test_env_variables_override_env_file ___[0m
[1m[31m/mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/unit/test_config/test_env_substitution.py[0m:191: in test_env_variables_override_env_file
    [0m[94massert[39;49;00m config.project_x_username == [33m"[39;49;00m[33mdotenv_user[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: assert 'jakertrader\r' == 'dotenv_user'[0m
[1m[31mE     [0m
[1m[31mE     [0m[91m- dotenv_user[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [92m+ jakertrader[39;49;00m[90m[39;49;00m[0m
[31m[1m_______ TestEnvironmentVariableSubstitution.test_env_file_with_comments ________[0m
[1m[31m/mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/unit/test_config/test_env_substitution.py[0m:319: in test_env_file_with_comments
    [0m[94massert[39;49;00m config.project_x_api_key == [33m"[39;49;00m[33mdotenv_key[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: assert 'tj5F5k0jDY2p...pNOz8W5n7s=\r' == 'dotenv_key'[0m
[1m[31mE     [0m
[1m[31mE     [0m[91m- dotenv_key[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [92m+ tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7s=[39;49;00m[90m[39;49;00m[0m
[31m[1m________ TestEnvironmentVariableSubstitution.test_env_file_with_quotes _________[0m
[1m[31m/mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/unit/test_config/test_env_substitution.py[0m:335: in test_env_file_with_quotes
    [0m[94massert[39;49;00m [33m"[39;49;00m[33mkey[39;49;00m[33m"[39;49;00m [95min[39;49;00m config.project_x_api_key[90m[39;49;00m
[1m[31mE   AssertionError: assert 'key' in 'tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7s=\r'[0m
[1m[31mE    +  where 'tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7s=\r' = EnvConfig(project_x_api_key='tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7s=\r', project_x_username='jakertrader\r', project_x_api_url='https://api.topstepx.com/api', project_x_websocket_url='wss://api.topstepx.com', max_daily_loss=-1000.0, max_contracts=5, require_stop_loss=True, stop_loss_grace_seconds=60, log_level='INFO', log_file=None, enforcement_latency_target_ms=500, max_events_per_second=1000, anthropic_api_key=None, enable_ai=False, enable_pattern_recognition=False, enable_anomaly_detection=False, discord_webhook_url=None, telegram_bot_token=None, telegram_chat_id=None, environment='development', debug=False).project_x_api_key[0m
[33m=============================== warnings summary ===============================[0m
.venv/lib/python3.13/site-packages/uvloop/__init__.py:154
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/.venv/lib/python3.13/site-packages/uvloop/__init__.py:154: DeprecationWarning: uvloop.install() is deprecated in favor of uvloop.run() starting with Python 3.12.
    _warnings.warn(

tests/unit/test_state/test_lockout_manager.py: 31 warnings
tests/unit/test_state/test_pnl_tracker.py: 12 warnings
tests/unit/test_state/test_reset_scheduler.py: 23 warnings
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/database.py:82: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (1, datetime.utcnow().isoformat()),

tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_auto_expires_after_duration
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_cleared_cancels_timer
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/lockout_manager.py:394: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self.timer_manager.cancel_timer(f"lockout_{account_id}")
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/test_state/test_pnl_tracker.py: 23 warnings
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/pnl_tracker.py:63: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_reset_clears_daily_pnl
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_resets_with_pnl
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/pnl_tracker.py:194: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m tests/unit/test_config/test_env_substitution.py::[1mTestEnvironmentVariableSubstitution::test_env_file_loading[0m - AssertionError: assert 'tj5F5k0jDY2p...pNOz8W5n7s=\r' == 'dotenv_key'
[31mFAILED[0m tests/unit/test_config/test_env_substitution.py::[1mTestEnvironmentVariableSubstitution::test_env_variables_override_env_file[0m - AssertionError: assert 'jakertrader\r' == 'dotenv_user'
[31mFAILED[0m tests/unit/test_config/test_env_substitution.py::[1mTestEnvironmentVariableSubstitution::test_env_file_with_comments[0m - AssertionError: assert 'tj5F5k0jDY2p...pNOz8W5n7s=\r' == 'dotenv_key'
[31mFAILED[0m tests/unit/test_config/test_env_substitution.py::[1mTestEnvironmentVariableSubstitution::test_env_file_with_quotes[0m - AssertionError: assert 'key' in 'tj5F5k0jDY2p3EKC2N6K88fgotPEaNyBDpNOz8W5n7...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_rule_initialization[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_position_below_limit_passes[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_zero_position_passes[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_position_at_limit_passes[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_position_exceeds_limit_violates[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_large_position_violates[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_multi_symbol_total_below_limit[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_multi_symbol_total_exceeds_limit[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_short_position_below_limit[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_short_position_exceeds_limit[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_flatten_action_in_violation[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_only_evaluates_position_events[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_evaluates_order_filled_event[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_missing_position_data[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31mERROR[0m tests/unit/test_rules/test_max_position_rule.py::[1mTestMaxPositionRuleUnit::test_violation_message_clarity[0m - pydantic_core._pydantic_core.ValidationError: 2 validation errors for RiskC...
[31m====== [31m[1m4 failed[0m, [32m482 passed[0m, [33m94 warnings[0m, [31m[1m15 errors[0m[31m in 106.79s (0:01:46)[0m[31m =======[0m


================================================================================
End of Report
================================================================================
