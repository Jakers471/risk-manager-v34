================================================================================
Risk Manager V34 - Test Report
================================================================================
Test Run: All tests
Timestamp: 2025-10-27 20:48:28
Status: FAILED
Exit Code: 1
================================================================================

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0 -- /mnt/c/Users/jakers/Desktop/risk-manager-v34/.venv/bin/python
cachedir: .pytest_cache
rootdir: /mnt/c/Users/jakers/Desktop/risk-manager-v34
configfile: pyproject.toml
plugins: anyio-4.11.0, asyncio-1.2.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
[1mcollecting ... [0mcollected 543 items

tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_position_below_limit_no_enforcement [32mPASSED[0m[33m [  0%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_position_exceeds_limit_triggers_enforcement [32mPASSED[0m[33m [  0%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_complete_flow_sdk_to_enforcement [32mPASSED[0m[33m [  0%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_multiple_position_updates [32mPASSED[0m[33m [  0%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_multi_symbol_total_exceeds_limit [32mPASSED[0m[33m [  0%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_enforcement_closes_positions_via_sdk [32mPASSED[0m[33m [  1%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_system_continues_after_handler_error [32mPASSED[0m[33m [  1%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_end_to_end_latency [32mPASSED[0m[33m [  1%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_state_remains_consistent_across_events [32mPASSED[0m[33m [  1%][0m
tests/e2e/test_max_contracts_e2e.py::TestMaxContractsE2E::test_realistic_day_trading_scenario [32mPASSED[0m[33m [  1%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_full_cooldown_flow_with_timer_expiry [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_tiered_cooldown_selects_correct_duration [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_tiered_cooldown_tier1 [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_tiered_cooldown_tier3 [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_timer_callback_clears_lockout [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_winning_trade_no_cooldown_no_timer [32mPASSED[0m[33m [  2%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_multi_account_independent_cooldowns [32mPASSED[0m[33m [  3%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_lockout_persists_to_database [32mPASSED[0m[33m [  3%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_lockout_loaded_from_database_on_restart [32mPASSED[0m[33m [  3%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_rapid_loss_sequence_only_first_triggers_timer [31mFAILED[0m[31m [  3%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_event_flow_from_trade_to_lockout [32mPASSED[0m[31m [  3%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_timer_precision_within_tolerance [32mPASSED[0m[31m [  4%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_database_cleanup_on_lockout_clear [32mPASSED[0m[31m [  4%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_position_closed_event_triggers_cooldown [31mFAILED[0m[31m [  4%][0m
tests/integration/test_cooldown_after_loss_integration.py::TestCooldownAfterLossIntegration::test_half_turn_trades_no_cooldown_no_timer [32mPASSED[0m[31m [  4%][0m
tests/integration/test_daily_realized_profit_integration.py::test_full_profit_target_flow_with_database [32mPASSED[0m[31m [  4%][0m
tests/integration/test_daily_realized_profit_integration.py::test_multi_account_independence [32mPASSED[0m[31m [  4%][0m
tests/integration/test_daily_realized_profit_integration.py::test_lockout_persistence_crash_recovery [32mPASSED[0m[31m [  5%][0m
tests/integration/test_daily_realized_profit_integration.py::test_reset_scheduler_integration [32mPASSED[0m[31m [  5%][0m
tests/integration/test_daily_realized_profit_integration.py::test_event_bus_async_flow [32mPASSED[0m[31m [  5%][0m
tests/integration/test_daily_realized_profit_integration.py::test_enforcement_action_integration [32mPASSED[0m[31m [  5%][0m
tests/integration/test_daily_realized_profit_integration.py::test_half_turn_trades_ignored [32mPASSED[0m[31m [  5%][0m
tests/integration/test_daily_realized_profit_integration.py::test_timer_auto_unlock [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_concurrent_access_thread_safety [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_database_schema_validation [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_mixed_profit_loss_day [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_lockout_prevents_further_evaluation [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_pnl_tracker_trade_count [32mPASSED[0m[31m [  6%][0m
tests/integration/test_daily_realized_profit_integration.py::test_reset_time_calculation [32mPASSED[0m[31m [  7%][0m
tests/integration/test_daily_realized_profit_integration.py::test_boundary_exactly_at_target [32mPASSED[0m[31m [  7%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_full_unrealized_loss_violation_flow [32mPASSED[0m[31m [  7%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_multi_position_independence [32mPASSED[0m[31m [  7%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_real_pnl_calculation_accuracy [32mPASSED[0m[31m [  7%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_market_price_updates_real_time_monitoring [32mPASSED[0m[31m [  8%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_different_tick_sizes_calculation [32mPASSED[0m[31m [  8%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_no_lockout_created_on_violation [32mPASSED[0m[31m [  8%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_event_bus_integration_complete_flow [32mPASSED[0m[31m [  8%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_position_closed_before_violation [32mPASSED[0m[31m [  8%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_long_and_short_positions_accuracy [32mPASSED[0m[31m [  9%][0m
tests/integration/test_daily_unrealized_loss_integration.py::TestDailyUnrealizedLossIntegration::test_enforcement_action_close_position_not_flatten_all [32mPASSED[0m[31m [  9%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_event_bus_publishes_to_subscribers [32mPASSED[0m[31m [  9%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_event_bus_multiple_subscribers [32mPASSED[0m[31m [  9%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_engine_evaluates_rule_on_event [32mPASSED[0m[31m [  9%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_engine_skips_rules_when_no_violation [32mPASSED[0m[31m [  9%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_violation_triggers_flatten_enforcement [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_violation_publishes_event [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_end_to_end_position_violation_flow [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_multiple_rules_evaluated_in_order [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_event_bus_handles_handler_errors [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_engine_tracks_position_state [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_flatten_action_calls_flatten_all [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_pause_action_triggers_pause_trading [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_event_processing_is_fast [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_event_pipeline_integration.py::TestEventPipelineIntegration::test_multi_symbol_position_tracking [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_grace_period_timer_expires_and_closes_position [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_stop_loss_placed_cancels_timer_no_enforcement [32mPASSED[0m[31m [ 12%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_multiple_positions_independent_timers [31mFAILED[0m[31m [ 12%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_position_closed_before_grace_expires [32mPASSED[0m[31m [ 12%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_real_async_timer_callback_execution [31mFAILED[0m[31m [ 12%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_order_type_detection_only_stops_cancel_timer [32mPASSED[0m[31m [ 12%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_event_bus_integration_with_rule_events [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_timer_recreated_after_manager_restart [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_concurrent_timer_operations [31mFAILED[0m[31m [ 13%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_enforcement_failure_does_not_crash [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_rule_status_shows_active_timers [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_no_stop_loss_grace_integration.py::TestNoStopLossGraceIntegration::test_disabled_rule_integration [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_outside_hours_lockout_flow [32mPASSED[0m[31m [ 14%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_inside_hours_no_violation [32mPASSED[0m[31m [ 14%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_weekend_blocking_saturday [32mPASSED[0m[31m [ 14%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_weekend_blocking_sunday [31mFAILED[0m[31m [ 14%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_dst_spring_forward_transition [31mFAILED[0m[31m [ 14%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_dst_fall_back_transition [31mFAILED[0m[31m [ 15%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_lockout_persistence_across_restarts [31mFAILED[0m[31m [ 15%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_multi_account_independence [31mFAILED[0m[31m [ 15%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_event_bus_integration [31mFAILED[0m[31m [ 15%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_database_schema_validation [31mFAILED[0m[31m [ 15%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_lockout_auto_expiry [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_session_block_outside_integration.py::TestSessionBlockOutsideIntegration::test_different_timezone_support [31mFAILED[0m[31m [ 16%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_order_rejection_flow_integration [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_allowed_symbol_passes_integration [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_position_close_flow_integration [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_position_opened_triggers_violation [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_wildcard_prefix_matching_integration [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_wildcard_contains_matching_integration [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_wildcard_does_not_match_allowed_symbols [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_case_insensitive_matching_integration [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_wildcard_case_insensitive_integration [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_multi_symbol_account_selective_close [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_multiple_blocked_symbols_in_account [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_event_bus_handles_violation_errors [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_no_lockout_trade_by_trade_enforcement [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_end_to_end_multiple_event_types [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_symbol_matching_performance [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_symbol_blocks_integration.py::TestSymbolBlocksRuleIntegration::test_dynamic_blocked_list_update [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_frequency_limit_cooldown_flow [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_rolling_window_tracking [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_multi_tier_limits [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_database_persistence [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_timer_auto_unlock_integration [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_multi_account_independence [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_session_reset [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_priority_order [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_concurrent_rapid_fire_trades [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_timer_cancellation_and_restart [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_database_query_performance [32mPASSED[0m[31m [ 21%][0m
tests/integration/test_trade_frequency_limit_integration.py::TestTradeFrequencyLimitIntegration::test_error_recovery_database_unavailable [32mPASSED[0m[31m [ 21%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_auto_stop_loss_placement_es_long [32mPASSED[0m[31m [ 21%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_auto_stop_loss_placement_mnq_short [31mFAILED[0m[31m [ 21%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_auto_take_profit_placement [31mFAILED[0m[31m [ 21%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_bracket_order_creation [31mFAILED[0m[31m [ 22%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_trailing_stop_adjustment_on_profit [31mFAILED[0m[31m [ 22%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_trailing_stop_not_adjusted_on_loss [32mPASSED[0m[31m [ 22%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_multi_symbol_independent_management [31mFAILED[0m[31m [ 22%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_position_closed_orders_cleanup [32mPASSED[0m[31m [ 22%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_event_bus_routes_to_rule [31mFAILED[0m[31m [ 23%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_stop_loss_disabled_only_take_profit [31mFAILED[0m[31m [ 23%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_take_profit_disabled_only_stop_loss [31mFAILED[0m[31m [ 23%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_complete_order_placement_flow [31mFAILED[0m[31m [ 23%][0m
tests/integration/test_trade_management_integration.py::TestTradeManagementIntegration::test_event_processing_performance [31mFAILED[0m[31m [ 23%][0m
tests/runtime/test_async_debug.py::test_async_task_creation [32mPASSED[0m[31m       [ 23%][0m
tests/runtime/test_async_debug.py::test_async_task_lifecycle [32mPASSED[0m[31m      [ 24%][0m
tests/runtime/test_async_debug.py::test_async_task_cancellation [32mPASSED[0m[31m   [ 24%][0m
tests/runtime/test_async_debug.py::test_async_race_condition_detection [32mPASSED[0m[31m [ 24%][0m
tests/runtime/test_async_debug.py::test_async_deadlock_prevention [32mPASSED[0m[31m [ 24%][0m
tests/runtime/test_async_debug.py::test_async_resource_leak_detection [32mPASSED[0m[31m [ 24%][0m
tests/runtime/test_async_debug.py::test_async_task_duration_tracking [32mPASSED[0m[31m [ 25%][0m
tests/runtime/test_async_debug.py::test_async_slow_task_detection [32mPASSED[0m[31m [ 25%][0m
tests/runtime/test_async_debug.py::test_async_memory_usage [32mPASSED[0m[31m        [ 25%][0m
tests/runtime/test_async_debug.py::test_async_exception_tracking [32mPASSED[0m[31m  [ 25%][0m
tests/runtime/test_async_debug.py::test_async_timeout_detection [32mPASSED[0m[31m   [ 25%][0m
tests/runtime/test_async_debug.py::test_async_task_inspection [32mPASSED[0m[31m     [ 25%][0m
tests/runtime/test_async_debug.py::test_async_event_loop_monitoring [32mPASSED[0m[31m [ 26%][0m
tests/runtime/test_async_debug.py::test_async_debug_logging [32mPASSED[0m[31m       [ 26%][0m
tests/runtime/test_dry_run.py::test_dry_run_enabled [32mPASSED[0m[31m               [ 26%][0m
tests/runtime/test_dry_run.py::test_dry_run_no_real_trades [32mPASSED[0m[31m        [ 26%][0m
tests/runtime/test_dry_run.py::test_dry_run_simulates_positions [32mPASSED[0m[31m   [ 26%][0m
tests/runtime/test_dry_run.py::test_dry_run_logs_actions [32mPASSED[0m[31m          [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_validates_operations [32mPASSED[0m[31m  [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_tracks_simulated_state [32mPASSED[0m[31m [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_pnl_calculation [31mFAILED[0m[31m       [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_state_isolation [32mPASSED[0m[31m       [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_vs_real_comparison [31mFAILED[0m[31m    [ 27%][0m
tests/runtime/test_dry_run.py::test_dry_run_same_logic [32mPASSED[0m[31m            [ 28%][0m
tests/runtime/test_dry_run.py::test_dry_run_detects_errors [32mPASSED[0m[31m        [ 28%][0m
tests/runtime/test_dry_run.py::test_dry_run_error_handling [32mPASSED[0m[31m        [ 28%][0m
tests/runtime/test_dry_run.py::test_dry_run_generates_report [32mPASSED[0m[31m      [ 28%][0m
tests/runtime/test_dry_run.py::test_dry_run_summary_statistics [32mPASSED[0m[31m    [ 28%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_initial_alive [32mPASSED[0m[31m     [ 29%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_regular_updates [32mPASSED[0m[31m   [ 29%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_timestamp_recent [32mPASSED[0m[31m  [ 29%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_health_status_healthy [32mPASSED[0m[31m [ 29%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_continuous_monitoring [32mPASSED[0m[31m [ 29%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_timeout_failure [32mPASSED[0m[31m   [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_monitor_stopped [32mPASSED[0m[31m   [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_degraded_health [32mPASSED[0m[31m   [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_unhealthy_status [32mPASSED[0m[31m  [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_uptime_tracking [32mPASSED[0m[31m   [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_uptime_reset_on_restart [32mPASSED[0m[31m [ 30%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_recovery_after_pause [32mPASSED[0m[31m [ 31%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_automatic_restart [32mPASSED[0m[31m [ 31%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_metrics_collection [32mPASSED[0m[31m [ 31%][0m
tests/runtime/test_heartbeat.py::test_heartbeat_interval_consistency [32mPASSED[0m[31m [ 31%][0m
tests/runtime/test_post_conditions.py::test_post_condition_state_valid_after_trade [32mPASSED[0m[31m [ 31%][0m
tests/runtime/test_post_conditions.py::test_post_condition_positions_consistent [32mPASSED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_rules_enforced [32mPASSED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_event_bus_operational [31mFAILED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_memory_bounds [32mPASSED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_invalid_state [32mPASSED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_data_inconsistency [32mPASSED[0m[31m [ 32%][0m
tests/runtime/test_post_conditions.py::test_post_condition_constraint_violated [32mPASSED[0m[31m [ 33%][0m
tests/runtime/test_post_conditions.py::test_post_condition_timeout [32mPASSED[0m[31m [ 33%][0m
tests/runtime/test_post_conditions.py::test_post_condition_multiple_checks [32mPASSED[0m[31m [ 33%][0m
tests/runtime/test_post_conditions.py::test_post_condition_partial_failure [32mPASSED[0m[31m [ 33%][0m
tests/runtime/test_post_conditions.py::test_post_condition_invariant_maintained [32mPASSED[0m[31m [ 33%][0m
tests/runtime/test_post_conditions.py::test_post_condition_referential_integrity [32mPASSED[0m[31m [ 34%][0m
tests/runtime/test_post_conditions.py::test_post_condition_audit_trail [32mPASSED[0m[31m [ 34%][0m
tests/runtime/test_smoke.py::test_smoke_basic_startup_success [32mPASSED[0m[31m     [ 34%][0m
tests/runtime/test_smoke.py::test_smoke_configuration_load_success [32mPASSED[0m[31m [ 34%][0m
tests/runtime/test_smoke.py::test_smoke_event_bus_success [31mFAILED[0m[31m         [ 34%][0m
tests/runtime/test_smoke.py::test_smoke_rule_engine_success [32mPASSED[0m[31m       [ 34%][0m
tests/runtime/test_smoke.py::test_smoke_state_tracking_success [31mFAILED[0m[31m    [ 35%][0m
tests/runtime/test_smoke.py::test_smoke_missing_config_failure [32mPASSED[0m[31m    [ 35%][0m
tests/runtime/test_smoke.py::test_smoke_invalid_config_failure [32mPASSED[0m[31m    [ 35%][0m
tests/runtime/test_smoke.py::test_smoke_startup_timeout_failure [32mPASSED[0m[31m   [ 35%][0m
tests/runtime/test_smoke.py::test_smoke_dependency_failure [32mPASSED[0m[31m        [ 35%][0m
tests/runtime/test_smoke.py::test_smoke_full_suite_success [32mPASSED[0m[31m        [ 36%][0m
tests/runtime/test_smoke.py::test_smoke_partial_failure [32mPASSED[0m[31m           [ 36%][0m
tests/runtime/test_smoke.py::test_smoke_log_output_verification [32mPASSED[0m[31m   [ 36%][0m
tests/runtime/test_smoke.py::test_smoke_error_log_output [32mPASSED[0m[31m          [ 36%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_engine_accepts_trading_integration [32mPASSED[0m[31m [ 36%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_flatten_all_calls_trading_integration [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_flatten_all_without_trading_integration [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_enforcement_wiring.py::TestEnforcementWiring::test_enforcement_from_violation [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_create_event_bus [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_subscribe_to_event [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_subscribe_multiple_callbacks [32mPASSED[0m[31m [ 37%][0m
tests/unit/test_core/test_events.py::TestEventBus::test_unsubscribe_from_event [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_core/test_events.py::TestRiskEvent::test_create_event [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_core/test_events.py::TestRiskEvent::test_event_has_timestamp [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_core/test_events.py::TestEventType::test_event_types_exist [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization [32mPASSED[0m[31m [ 38%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_validates_thresholds [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_validates_duration [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_rule_initialization_sorts_thresholds [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_winning_trade_no_cooldown [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_breakeven_trade_no_cooldown [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_small_loss_below_threshold [32mPASSED[0m[31m [ 39%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_loss_at_threshold_triggers_cooldown [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_loss_exceeds_threshold_triggers_cooldown [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier1 [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier2 [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_tier3 [32mPASSED[0m[31m [ 40%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_tiered_cooldown_selects_highest_tier [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_cooldown_starts_timer [31mFAILED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_cooldown_expires_unlocks_account [31mFAILED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_already_in_cooldown_skips_evaluation [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_half_turn_trade_ignored [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_only_evaluates_trade_executed_events [32mPASSED[0m[31m [ 41%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_evaluates_position_closed_events [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_missing_account_id [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_missing_pnl_field [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_cooldown_after_loss.py::TestCooldownAfterLossRule::test_violation_message_clarity [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization [32mPASSED[0m[31m [ 42%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization_custom_limit [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_initialization_validates_limit [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_below_limit_passes [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_profitable_day_passes [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_at_limit_passes [32mPASSED[0m[31m [ 43%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_loss_exceeds_limit_violates [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_large_loss_violates [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_violation_triggers_lockout [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_lockout_persists_until_reset [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_multi_symbol_loss_tracking [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_ignores_half_turn_trades [32mPASSED[0m[31m [ 44%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_counts_only_closed_positions [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_approaching_limit_warning [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_rule_disabled_when_locked [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_enforcement_action_correct [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_only_evaluates_pnl_events [32mPASSED[0m[31m [ 45%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_evaluates_pnl_updated_event [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_zero_pnl [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_missing_pnl_data [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_loss.py::TestDailyRealizedLossRule::test_violation_message_clarity [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization_custom_target [32mPASSED[0m[31m [ 46%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_initialization_validates_target [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_below_target_passes [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_losing_day_passes [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_at_target_violates [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_profit_exceeds_target_violates [32mPASSED[0m[31m [ 47%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_large_profit_violates [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_violation_triggers_lockout [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_lockout_persists_until_reset [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_multi_symbol_profit_tracking [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_ignores_half_turn_trades [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_counts_only_closed_positions [32mPASSED[0m[31m [ 48%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_approaching_target_no_violation [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_disabled_when_locked [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_enforcement_action_correct [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_only_evaluates_pnl_events [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_evaluates_pnl_updated_event [32mPASSED[0m[31m [ 49%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_zero_pnl [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_missing_pnl_data [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_violation_message_clarity [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_mixed_trades_reach_target [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_success_message_positive_tone [32mPASSED[0m[31m [ 50%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_cannot_trigger_both_profit_and_loss [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_rule_can_be_disabled [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_enforce_method_sets_lockout [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_realized_profit.py::TestDailyRealizedProfitRule::test_reset_time_calculation [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_initialization [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_initialization_validates_negative_limit [32mPASSED[0m[31m [ 51%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_within_limit_passes [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_zero_loss_passes [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_profit_does_not_trigger [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_at_exact_limit_violates [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_loss_exceeds_limit_violates [32mPASSED[0m[31m [ 52%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_short_position_loss_exceeds_limit [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_violation_targets_specific_position_only [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_violation_does_not_create_lockout [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_multi_symbol_independent_tracking [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_long_position_pnl_calculation [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_es_position_pnl_calculation [32mPASSED[0m[31m [ 53%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_missing_market_price_returns_none [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_small_loss_within_limit [32mPASSED[0m[31m [ 54%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_disabled_rule_does_not_trigger [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rule_name [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_rty_symbol_tick_calculation [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_daily_unrealized_loss.py::TestDailyUnrealizedLossRule::test_zero_size_position_returns_zero_pnl [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_rule_initialization [32mPASSED[0m[31m [ 55%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_rule_initialization_custom_action [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_below_limit_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_zero_position_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_at_limit_passes [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_position_exceeds_limit_violates [32mPASSED[0m[31m [ 56%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_large_position_violates [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_multi_symbol_total_below_limit [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_multi_symbol_total_exceeds_limit [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_short_position_below_limit [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_short_position_exceeds_limit [32mPASSED[0m[31m [ 57%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_flatten_action_in_violation [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_reject_action_in_violation [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_only_evaluates_position_events [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_evaluates_order_filled_event [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_negative_limit_raises_error [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_zero_limit [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_missing_position_data [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_max_position_rule.py::TestMaxPositionRuleUnit::test_violation_message_clarity [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_rule_initialization [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_rule_initialization_validates_positive_target [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_below_target_passes [32mPASSED[0m[31m [ 59%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_zero_profit_passes [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_at_exact_target_passes [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_profit_exceeds_target_violates [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_short_position_profit_exceeds_target [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_violation_targets_specific_position_only [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_violation_does_not_create_lockout [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_multi_symbol_independent_tracking [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_long_position_pnl_calculation [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_mnq_position_pnl_calculation [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 61%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_missing_market_price_returns_none [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_max_unrealized_profit.py::TestMaxUnrealizedProfitRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_initialization [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_can_be_disabled [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_starts_grace_period_timer [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_with_zero_size_ignored [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_opened_missing_contract_id_ignored [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_placed_cancels_grace_period [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_without_stop_price_ignored [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_non_stop_order_ignored [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_stop_order_for_different_position_ignored [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_grace_period_expiry_closes_position [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_grace_period_expiry_with_actual_timer [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_closed_cancels_grace_period [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_multiple_positions_tracked_separately [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_rule_disabled_no_timers_started [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_get_status [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_position_reopened_restarts_timer [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_enforcement_failure_logged [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_no_stop_loss_grace.py::test_ignore_non_position_and_order_events [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization_with_custom_hours [32mPASSED[0m[31m [ 65%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_initialization_validates_time_format [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_disabled_when_config_disabled [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_converts_et_to_utc_correctly [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_handles_dst_transitions [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_inside_hours_passes [32mPASSED[0m[31m [ 66%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_at_session_start_passes [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_just_before_session_end_passes [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_before_session_start_violates [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_after_session_end_violates [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_at_session_end_violates [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_on_saturday_violates [32mPASSED[0m[31m [ 67%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_trading_on_sunday_violates [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_weekend_blocking_can_be_disabled [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_violation_triggers_lockout_until_session_start [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_lockout_skips_weekends [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_enforcement_sets_lockout [32mPASSED[0m[31m [ 68%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_handles_missing_account_id_gracefully [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_rule_disabled_skips_evaluation [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_already_locked_account_skips_evaluation [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_violation_message_clarity [32mPASSED[0m[31m [ 69%][0m
tests/unit/test_rules/test_session_block_outside.py::TestSessionBlockOutsideRule::test_different_timezones_supported [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization_with_wildcards [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_rule_initialization_empty_list [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_allowed_symbol_passes [32mPASSED[0m[31m [ 70%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_multiple_allowed_symbols_pass [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_blocked_symbol_violates [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_position_in_blocked_symbol_violates [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_all_blocked_symbols_violate [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_uppercase [32mPASSED[0m[31m [ 71%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_lowercase [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_case_insensitive_mixed_case [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_prefix_match [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_contains_match [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_no_match [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_wildcard_case_insensitive [32mPASSED[0m[31m [ 72%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_order_placed_event [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_evaluates_position_updated_event [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_ignores_irrelevant_events [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_no_lockout_on_violation [32mPASSED[0m[31m [ 73%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_empty_blocked_list_allows_all [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_missing_symbol_in_event [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_none_symbol_in_event [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_disabled_rule_allows_all [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_violation_message_clarity [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_violation_includes_rule_name [32mPASSED[0m[31m [ 74%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_multiple_exact_matches [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_symbol_blocks.py::TestSymbolBlocksRuleUnit::test_mixed_exact_and_wildcard [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization_custom_limits [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_initialization_validates_limits [32mPASSED[0m[31m [ 75%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_within_minute_limit_passes [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_within_hour_limit_passes [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_first_trade_of_day_passes [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_trades_at_minute_limit_passes [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_minute_limit_exceeded_violates [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_minute_limit_significantly_exceeded [32mPASSED[0m[31m [ 76%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_hour_limit_exceeded_violates [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_per_session_limit_exceeded_violates [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_starts_cooldown_timer [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_different_cooldowns_for_different_breaches [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rolling_window_only_counts_recent_trades [32mPASSED[0m[31m [ 77%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_old_trades_expire_from_window [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_multiple_accounts_tracked_independently [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_cooldown_auto_unlocks_via_timer [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_minute_limit_takes_priority [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_only_evaluates_trade_executed_events [32mPASSED[0m[31m [ 78%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_evaluates_all_trade_types [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_missing_account_id [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_database_error_handled [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_zero_cooldown_duration [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_message_clarity [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_violation_includes_countdown_info [32mPASSED[0m[31m [ 79%][0m
tests/unit/test_rules/test_trade_frequency_limit.py::TestTradeFrequencyLimitRule::test_rule_disabled_skips_evaluation [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_initialization [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_initialization_with_partial_config [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_stop_loss_on_long_position_open [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_stop_loss_on_short_position_open [32mPASSED[0m[31m [ 80%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_take_profit_on_long_position_open [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_take_profit_on_short_position_open [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_place_bracket_order_on_position_open [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_adjust_trailing_stop_on_profit [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_trailing_stop_not_adjusted_on_loss [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_no_stop_loss_when_disabled [32mPASSED[0m[31m [ 81%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_independent_management_per_symbol [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_only_evaluates_position_events [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_evaluates_position_opened_event [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_missing_symbol_returns_none [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_missing_position_data_returns_none [32mPASSED[0m[31m [ 82%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_rule_disabled_returns_none [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_stop_price_long [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_stop_price_short [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_target_price_long [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_rules/test_trade_management.py::TestTradeManagementRule::test_calculate_target_price_short [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_set_lockout_locks_account [32mPASSED[0m[31m [ 83%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_is_locked_out_returns_true_when_locked [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_is_locked_out_returns_false_when_not_locked [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_get_lockout_info_returns_details [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_get_lockout_info_returns_none_when_not_locked [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestHardLockoutOperations::test_clear_lockout_removes_lockout [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_set_cooldown_creates_timer [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_auto_expires_after_duration [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_remaining_time_decreases [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_cleared_cancels_timer [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_integrates_with_timer_manager [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_check_expired_lockouts_runs_every_second [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_expired_lockout_auto_cleared [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestBackgroundTask::test_background_task_stops_on_shutdown [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_multiple_accounts_locked_independently [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_lockout_affects_only_target_account [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestMultipleAccounts::test_clear_lockout_affects_only_target_account [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_lockout_saved_to_database [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_lockout_deleted_from_database_on_clear [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_load_lockouts_populates_memory_state [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_expired_lockout_removed_from_database [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestDatabasePersistence::test_database_schema_correct [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_lockout_until_past_time_immediately_expired [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_lockout_reason_persisted_correctly [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestEdgeCases::test_double_lockout_overwrites_previous [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestEventRouterIntegration::test_locked_account_blocks_rule_processing [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestEventRouterIntegration::test_unlocked_account_allows_rule_processing [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestLockoutTypes::test_hard_lockout_type_stored_correctly [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_state/test_lockout_manager.py::TestLockoutTypes::test_cooldown_type_stored_correctly [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_lockout_manager.py::TestStartupShutdown::test_lockouts_restored_on_startup [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_lockout_manager.py::TestStartupShutdown::test_shutdown_cancels_all_timers [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_tracker_initializes [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_get_daily_pnl_returns_zero_for_new_account [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerBasics::test_add_trade_pnl_updates_daily_total [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerPersistence::test_pnl_survives_restart [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerPersistence::test_multiple_accounts_tracked_independently [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_reset_clears_daily_pnl [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_different_dates_tracked_separately [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_increments [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_resets_with_pnl [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_handles_zero_pnl_trades [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_handles_large_pnl_values [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerEdgeCases::test_get_all_account_pnls [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_schedule_daily_reset_creates_schedule [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_converts_et_to_utc [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_persists_to_database [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_clears_pnl_tracker [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_clears_lockout [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDailyResetScheduling::test_daily_reset_does_not_trigger_twice_same_day [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_schedule_weekly_reset_creates_schedule [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_weekly_reset_triggers_on_monday [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestWeeklyResetScheduling::test_weekly_reset_clears_weekly_pnl [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_et_to_utc_conversion_standard_time [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_et_to_utc_conversion_daylight_time [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestTimezoneHandling::test_dst_transition_handling [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabasePersistence::test_reset_log_saved_to_database [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabasePersistence::test_last_reset_time_loaded_from_database [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_background_task_checks_every_minute [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_reset_triggered_automatically_at_time [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestBackgroundTask::test_shutdown_stops_background_task [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_multiple_accounts_independent_schedules [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_reset_time_calculation_near_midnight [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestEdgeCases::test_unscheduled_account_returns_none [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestDatabaseSchema::test_reset_log_table_created [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestIntegration::test_reset_sequence_executes_in_order [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_reset_scheduler.py::TestIntegration::test_full_lifecycle_start_to_stop [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_state/test_timer_manager.py::test_start_timer_creates_timer [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_get_remaining_time_decreases [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_timer_removes_timer [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_expired_timer_executes_callback [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_expired_timer_auto_removed [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_state/test_timer_manager.py::test_multiple_timers_run_simultaneously [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_timers_expire_independently [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_specific_timer_preserves_others [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_receives_correct_context [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_exception_doesnt_crash_manager [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_callback_executes_exactly_once [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_state/test_timer_manager.py::test_async_callback_supported [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_zero_duration_timer_executes_immediately [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_negative_duration_raises_error [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_timer_precision_within_tolerance [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_check_timers_runs_every_second [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_state/test_timer_manager.py::test_check_timers_stops_on_shutdown [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_get_remaining_time_nonexistent_timer_returns_zero [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_cancel_nonexistent_timer_no_error [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_duplicate_timer_name_overwrites_previous [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_has_timer_returns_false_for_nonexistent [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_state/test_timer_manager.py::test_start_timer_without_callback_raises_error [32mPASSED[0m[31m [100%][0m

=================================== FAILURES ===================================
[31m[1m_ TestCooldownAfterLossIntegration.test_rapid_loss_sequence_only_first_triggers_timer _[0m
[1m[31mtests/integration/test_cooldown_after_loss_integration.py[0m:535: in test_rapid_loss_sequence_only_first_triggers_timer
    [0m[94massert[39;49;00m timer_manager.has_timer([33mf[39;49;00m[33m"[39;49;00m[33mcooldown_[39;49;00m[33m{[39;49;00maccount_id[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   AssertionError: assert False[0m
[1m[31mE    +  where False = has_timer('cooldown_777')[0m
[1m[31mE    +    where has_timer = <risk_manager.state.timer_manager.TimerManager object at 0x71b5550e2050>.has_timer[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 TimerManager initialized

[32mINFO    [0m root:conftest.py:37 Background task started

[32mINFO    [0m root:conftest.py:37 TimerManager started

[32mINFO    [0m root:conftest.py:37 Timer loop started

[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_rapid_loss_sequence_only_0/test_cooldown_integration.db

[32mINFO    [0m root:conftest.py:37 PnLTracker initialized

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 CooldownAfterLossRule initialized: 1 tiers
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Loss $-80.00 below all thresholds, no cooldown

[32mINFO    [0m root:conftest.py:37 Cooldown triggered for account 777: Loss=$-120.00, Cooldown=2s

[32mINFO    [0m root:conftest.py:37 ENFORCING RULE-007: Account 777 Loss: $-120.00, Cooldown: 2s

[32mINFO    [0m root:conftest.py:37 Timer started: lockout_777 (duration=2s, expires=20:45:37)

[32mINFO    [0m root:conftest.py:37 Timer started for account 777 cooldown

[32mINFO    [0m root:conftest.py:37 Account 777 cooldown for 2s: Cooldown triggered after $-120.00 loss (2s cooldown)

[32mINFO    [0m root:conftest.py:37 Account 777 locked for 2s: Cooldown triggered after $-120.00 loss (2s cooldown)
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Timer cancelled: lockout_777

[32mINFO    [0m root:conftest.py:37 Error cancelling timer for account 777: object NoneType can't be used in 'await' expression

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed

[32mINFO    [0m root:conftest.py:37 Timer loop cancelled

[32mINFO    [0m root:conftest.py:37 Timer loop stopped

[32mINFO    [0m root:conftest.py:37 TimerManager stopped
[31m[1m_ TestCooldownAfterLossIntegration.test_position_closed_event_triggers_cooldown _[0m
[1m[31mtests/integration/test_cooldown_after_loss_integration.py[0m:749: in test_position_closed_event_triggers_cooldown
    [0m[94massert[39;49;00m timer_manager.has_timer([33mf[39;49;00m[33m"[39;49;00m[33mcooldown_[39;49;00m[33m{[39;49;00maccount_id[33m}[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
[1m[31mE   AssertionError: assert False[0m
[1m[31mE    +  where False = has_timer('cooldown_1111')[0m
[1m[31mE    +    where has_timer = <risk_manager.state.timer_manager.TimerManager object at 0x71b5551760b0>.has_timer[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 TimerManager initialized

[32mINFO    [0m root:conftest.py:37 Background task started

[32mINFO    [0m root:conftest.py:37 TimerManager started

[32mINFO    [0m root:conftest.py:37 Timer loop started

[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_position_closed_event_tri0/test_cooldown_integration.db

[32mINFO    [0m root:conftest.py:37 PnLTracker initialized

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 CooldownAfterLossRule initialized: 1 tiers
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Cooldown triggered for account 1111: Loss=$-175.00, Cooldown=2s

[32mINFO    [0m root:conftest.py:37 ENFORCING RULE-007: Account 1111 Loss: $-175.00, Cooldown: 2s

[32mINFO    [0m root:conftest.py:37 Timer started: lockout_1111 (duration=2s, expires=20:45:50)

[32mINFO    [0m root:conftest.py:37 Timer started for account 1111 cooldown

[32mINFO    [0m root:conftest.py:37 Account 1111 cooldown for 2s: Cooldown triggered after $-175.00 loss (2s cooldown)

[32mINFO    [0m root:conftest.py:37 Account 1111 locked for 2s: Cooldown triggered after $-175.00 loss (2s cooldown)
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Timer cancelled: lockout_1111

[32mINFO    [0m root:conftest.py:37 Error cancelling timer for account 1111: object NoneType can't be used in 'await' expression

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed

[32mINFO    [0m root:conftest.py:37 Timer loop cancelled

[32mINFO    [0m root:conftest.py:37 Timer loop stopped

[32mINFO    [0m root:conftest.py:37 TimerManager stopped
[31m[1m__ TestNoStopLossGraceIntegration.test_multiple_positions_independent_timers ___[0m
[1m[31mC:\Users\jakers\Desktop\risk-manager-v34\tests\integration\test_no_stop_loss_grace_integration.py[0m:264: in test_multiple_positions_independent_timers
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   assert 0 == 1[0m
[1m[31mE    +  where 0 = len([])[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 TimerManager initialized

[32mINFO    [0m root:conftest.py:37 Background task started

[32mINFO    [0m root:conftest.py:37 TimerManager started

[32mINFO    [0m root:conftest.py:37 Timer loop started

[32mINFO    [0m root:conftest.py:37 NoStopLossGraceRule initialized - Grace period: 2s, Enforcement: close_position, Enabled: True
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened ES/CON.F.US.ES.H25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.ES.H25 (duration=2s, expires=20:46:02)

[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened MNQ/CON.F.US.MNQ.Z25 (size=2), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.MNQ.Z25 (duration=2s, expires=20:46:02)

[32mINFO    [0m root:conftest.py:37 Timer cancelled: no_stop_loss_grace_CON.F.US.ES.H25

[32mINFO    [0m root:conftest.py:37 RULE-008: Stop-loss order placed for ES/CON.F.US.ES.H25 (stopPrice=5180.0), grace period cancelled ✅
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Timer loop cancelled

[32mINFO    [0m root:conftest.py:37 Timer loop stopped

[32mINFO    [0m root:conftest.py:37 TimerManager stopped
[31m[1m___ TestNoStopLossGraceIntegration.test_real_async_timer_callback_execution ____[0m
[1m[31mC:\Users\jakers\Desktop\risk-manager-v34\tests\integration\test_no_stop_loss_grace_integration.py[0m:361: in test_real_async_timer_callback_execution
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   assert 0 == 1[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 TimerManager initialized

[32mINFO    [0m root:conftest.py:37 Background task started

[32mINFO    [0m root:conftest.py:37 TimerManager started

[32mINFO    [0m root:conftest.py:37 Timer loop started
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Timer started: test_timer (duration=1s, expires=20:46:06)
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Timer loop cancelled

[32mINFO    [0m root:conftest.py:37 Timer loop stopped

[32mINFO    [0m root:conftest.py:37 TimerManager stopped
[31m[1m_______ TestNoStopLossGraceIntegration.test_concurrent_timer_operations ________[0m
[1m[31mC:\Users\jakers\Desktop\risk-manager-v34\tests\integration\test_no_stop_loss_grace_integration.py[0m:642: in test_concurrent_timer_operations
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   assert 0 == 2[0m
[1m[31mE    +  where 0 = len([])[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 TimerManager initialized

[32mINFO    [0m root:conftest.py:37 Background task started

[32mINFO    [0m root:conftest.py:37 TimerManager started

[32mINFO    [0m root:conftest.py:37 Timer loop started

[32mINFO    [0m root:conftest.py:37 NoStopLossGraceRule initialized - Grace period: 2s, Enforcement: close_position, Enabled: True
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened SYM0/CON.F.US.MNQ.Z25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.MNQ.Z25 (duration=2s, expires=20:46:11)

[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened SYM1/CON.F.US.ES.H25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.ES.H25 (duration=2s, expires=20:46:12)

[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened SYM2/CON.F.US.NQ.Z25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.NQ.Z25 (duration=2s, expires=20:46:12)

[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened SYM3/CON.F.US.YM.H25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.YM.H25 (duration=2s, expires=20:46:12)

[32mINFO    [0m root:conftest.py:37 RULE-008: Position opened SYM4/CON.F.US.RTY.Z25 (size=1), starting 2s grace period for stop-loss

[32mINFO    [0m root:conftest.py:37 Timer started: no_stop_loss_grace_CON.F.US.RTY.Z25 (duration=2s, expires=20:46:12)

[32mINFO    [0m root:conftest.py:37 Timer cancelled: no_stop_loss_grace_CON.F.US.MNQ.Z25

[32mINFO    [0m root:conftest.py:37 RULE-008: Stop-loss order placed for SYM0/CON.F.US.MNQ.Z25 (stopPrice=1000.0), grace period cancelled ✅

[32mINFO    [0m root:conftest.py:37 Timer cancelled: no_stop_loss_grace_CON.F.US.ES.H25

[32mINFO    [0m root:conftest.py:37 RULE-008: Stop-loss order placed for SYM1/CON.F.US.ES.H25 (stopPrice=1001.0), grace period cancelled ✅

[32mINFO    [0m root:conftest.py:37 Timer cancelled: no_stop_loss_grace_CON.F.US.NQ.Z25

[32mINFO    [0m root:conftest.py:37 RULE-008: Position closed for SYM2/CON.F.US.NQ.Z25, grace period cancelled
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Timer loop cancelled

[32mINFO    [0m root:conftest.py:37 Timer loop stopped

[32mINFO    [0m root:conftest.py:37 TimerManager stopped
[31m[1m_______ TestSessionBlockOutsideIntegration.test_weekend_blocking_sunday ________[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:372: in test_weekend_blocking_sunday
    [0mviolation = [94mawait[39;49;00m rule.evaluate(event, mock_engine)[90m[39;49;00m
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_weekend_blocking_sunday.<locals>.MockDateTime.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_weekend_blocking_sunday0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=True
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m____ TestSessionBlockOutsideIntegration.test_dst_spring_forward_transition _____[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:440: in test_dst_spring_forward_transition
    [0mviolation_before = [94mawait[39;49;00m rule.evaluate(event_before, mock_engine)[90m[39;49;00m
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_dst_spring_forward_transition.<locals>.MockDateTimeBefore.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_dst_spring_forward_transi0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=False
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m_______ TestSessionBlockOutsideIntegration.test_dst_fall_back_transition _______[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:519: in test_dst_fall_back_transition
    [0mviolation_before = [94mawait[39;49;00m rule.evaluate(event_before, mock_engine)[90m[39;49;00m
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_dst_fall_back_transition.<locals>.MockDateTimeBefore.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_dst_fall_back_transition0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=False
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m_ TestSessionBlockOutsideIntegration.test_lockout_persistence_across_restarts __[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:603: in test_lockout_persistence_across_restarts
    [0mviolation = [94mawait[39;49;00m rule1.evaluate(event, mock_engine)[90m[39;49;00m
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_lockout_persistence_across_restarts.<locals>.MockDateTime.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_lockout_persistence_acros0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=True

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started
[31m[1m______ TestSessionBlockOutsideIntegration.test_multi_account_independence ______[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:695: in test_multi_account_independence
    [0mviolation_a = [94mawait[39;49;00m rule.evaluate(event_a, mock_engine)[90m[39;49;00m
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_multi_account_independence.<locals>.MockDateTimeEarly.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_multi_account_independenc1/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=True
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m________ TestSessionBlockOutsideIntegration.test_event_bus_integration _________[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:799: in test_event_bus_integration
    [0mviolation = [94mawait[39;49;00m rule.evaluate(event, mock_engine)[90m[39;49;00m
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_event_bus_integration.<locals>.MockDateTime.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_event_bus_integration0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=True
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m______ TestSessionBlockOutsideIntegration.test_database_schema_validation ______[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:871: in test_database_schema_validation
    [0mviolation = [94mawait[39;49;00m rule.evaluate(event, mock_engine)[90m[39;49;00m
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_database_schema_validation.<locals>.MockDateTime.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_database_schema_validatio1/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started

[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=09:30-16:00 America/New_York, block_weekends=True
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m______ TestSessionBlockOutsideIntegration.test_different_timezone_support ______[0m
[1m[31mtests/integration/test_session_block_outside_integration.py[0m:1006: in test_different_timezone_support
    [0mviolation_ct = [94mawait[39;49;00m ct_rule.evaluate(event_ct, mock_engine)[90m[39;49;00m
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31msrc/risk_manager/rules/session_block_outside.py[0m:182: in evaluate
    [0mnow = datetime.now([96mself[39;49;00m.timezone)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: TestSessionBlockOutsideIntegration.test_different_timezone_support.<locals>.MockDateTimeCT.now() takes from 0 to 1 positional arguments but 2 were given[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Applying schema migration: v1 (initial schema)

[32mINFO    [0m root:conftest.py:37 Schema v1 applied successfully

[32mINFO    [0m root:conftest.py:37 Database initialized at /tmp/pytest-of-jakers/pytest-0/test_different_timezone_suppor0/test_session_block.db

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager initialized

[32mINFO    [0m root:conftest.py:37 Starting Lockout Manager

[32mINFO    [0m root:conftest.py:37 Loaded 0 lockouts from database

[32mINFO    [0m root:conftest.py:37 Lockout Manager started

[32mINFO    [0m root:conftest.py:37 Lockout expiry background task started
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 SessionBlockOutsideRule initialized: session=08:00-15:00 America/Chicago, block_weekends=True
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Shutting down Lockout Manager

[32mINFO    [0m root:conftest.py:37 Stopping Lockout Manager

[32mINFO    [0m root:conftest.py:37 Lockout Manager stopped

[32mINFO    [0m root:conftest.py:37 Lockout Manager shutdown complete

[32mINFO    [0m root:conftest.py:37 Database closed
[31m[1m____ TestTradeManagementIntegration.test_auto_stop_loss_placement_mnq_short ____[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:224: in test_auto_stop_loss_placement_mnq_short
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:48.702250Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:48.702877Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:48.702950Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for MNQ: Stop=$21002.50, Target=$20995.00', 'symbol': 'MNQ', 'contractId': 'CON.F.US.MNQ.U25', 'side': 'short', 'size': 2, 'entry_price': 21000.0, 'stop_price': 21002.5, 'take_profit_price': 20995.0, 'timestamp': '2025-10-28T01:46:48.702927+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m________ TestTradeManagementIntegration.test_auto_take_profit_placement ________[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:277: in test_auto_take_profit_placement
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:48.767610Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:48.768362Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:48.768434Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for ES: Stop=$4997.50, Target=$5005.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'stop_price': 4997.5, 'take_profit_price': 5005.0, 'timestamp': '2025-10-28T01:46:48.768412+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m__________ TestTradeManagementIntegration.test_bracket_order_creation __________[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:332: in test_bracket_order_creation
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:48.832368Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:48.833049Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:48.833119Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for MNQ: Stop=$20997.50, Target=$21005.00', 'symbol': 'MNQ', 'contractId': 'CON.F.US.MNQ.U25', 'side': 'long', 'size': 2, 'entry_price': 21000.0, 'stop_price': 20997.5, 'take_profit_price': 21005.0, 'timestamp': '2025-10-28T01:46:48.833095+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m____ TestTradeManagementIntegration.test_trailing_stop_adjustment_on_profit ____[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:390: in test_trailing_stop_adjustment_on_profit
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:48.895569Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:48.896261Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_updated - evaluating 1 rules
2025-10-28T01:46:48.896334Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'adjust_trailing_stop', 'message': 'Adjusting trailing stop for ES: $4997.50 -> $5000.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'current_price': 5002.0, 'extreme_price': 5002.0, 'old_stop_price': 4997.5, 'new_stop_price': 5000.0, 'timestamp': '2025-10-28T01:46:48.896310+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m___ TestTradeManagementIntegration.test_multi_symbol_independent_management ____[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:512: in test_multi_symbol_independent_management
    [0m[94massert[39;49;00m trade_mgmt_es [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:48.976303Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:48.976938Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:48.977006Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for ES: Stop=$4997.50, Target=$5005.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'stop_price': 4997.5, 'take_profit_price': 5005.0, 'timestamp': '2025-10-28T01:46:48.976984+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m_________ TestTradeManagementIntegration.test_event_bus_routes_to_rule _________[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:638: in test_event_bus_routes_to_rule
    [0m[94massert[39;49;00m result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:49.056130Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:49.057170Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:49.057296Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for ES: Stop=$4997.50, Target=$5005.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'stop_price': 4997.5, 'take_profit_price': 5005.0, 'timestamp': '2025-10-28T01:46:49.057263+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m___ TestTradeManagementIntegration.test_stop_loss_disabled_only_take_profit ____[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:720: in test_stop_loss_disabled_only_take_profit
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:49.116064Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
2025-10-28T01:46:49.116218Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:49.116271Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started

[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_take_profit', 'message': 'Placing take-profit for ES at $5005.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'take_profit_price': 5005.0, 'timestamp': '2025-10-28T01:46:49.116252+00:00'}
[31m[1m___ TestTradeManagementIntegration.test_take_profit_disabled_only_stop_loss ____[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:795: in test_take_profit_disabled_only_stop_loss
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:49.174677Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
2025-10-28T01:46:49.174847Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:49.174901Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started

[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_stop_loss', 'message': 'Placing stop-loss for ES at $4997.50', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'stop_price': 4997.5, 'timestamp': '2025-10-28T01:46:49.174882+00:00'}
[31m[1m______ TestTradeManagementIntegration.test_complete_order_placement_flow _______[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:856: in test_complete_order_placement_flow
    [0m[94massert[39;49;00m trade_mgmt_result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:49.243452Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:49.244178Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:49.244251Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for MNQ: Stop=$20997.50, Target=$21005.00', 'symbol': 'MNQ', 'contractId': 'CON.F.US.MNQ.U25', 'side': 'long', 'size': 2, 'entry_price': 21000.0, 'stop_price': 20997.5, 'take_profit_price': 21005.0, 'timestamp': '2025-10-28T01:46:49.244227+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m_______ TestTradeManagementIntegration.test_event_processing_performance _______[0m
[1m[31mtests/integration/test_trade_management_integration.py[0m:912: in test_event_processing_performance
    [0m[94massert[39;49;00m result [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m[90m[39;49;00m
[1m[31mE   assert None is not None[0m
---------------------------- Captured stdout setup -----------------------------
2025-10-28T01:46:49.311452Z | INFO     | engine.start:40 | ✅ Event loop running: 1 active rules monitoring events
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine initialized

[32mINFO    [0m root:conftest.py:37 Added rule: TradeManagementRule

[32mINFO    [0m root:conftest.py:37 Risk Engine started
----------------------------- Captured stdout call -----------------------------
2025-10-28T01:46:49.312599Z | INFO     | engine.evaluate_rules:70 | 📨 Event received: position_opened - evaluating 1 rules
2025-10-28T01:46:49.312693Z | INFO     | engine.evaluate_rules:77 | 🔍 Rule evaluated: TradeManagementRule - VIOLATED
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Rule violation: TradeManagementRule - {'rule': 'TradeManagementRule', 'action': 'place_bracket_order', 'message': 'Placing bracket order for ES: Stop=$4997.50, Target=$5005.00', 'symbol': 'ES', 'contractId': 'CON.F.US.ES.H25', 'side': 'long', 'size': 1, 'entry_price': 5000.0, 'stop_price': 4997.5, 'take_profit_price': 5005.0, 'timestamp': '2025-10-28T01:46:49.312667+00:00'}
---------------------------- Captured log teardown -----------------------------
[32mINFO    [0m root:conftest.py:37 Risk Engine stopped
[31m[1m_________________________ test_dry_run_pnl_calculation _________________________[0m
[1m[31mtests/runtime/test_dry_run.py[0m:175: in test_dry_run_pnl_calculation
    [0mdb = Database()[90m[39;49;00m
         ^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: Database.__init__() missing 1 required positional argument: 'db_path'[0m
[31m[1m_______________________ test_dry_run_vs_real_comparison ________________________[0m
[1m[31mtests/runtime/test_dry_run.py[0m:242: in test_dry_run_vs_real_comparison
    [0m[94massert[39;49;00m result[[33m'[39;49;00m[33mpassed[39;49;00m[33m'[39;49;00m] [95mis[39;49;00m [94mTrue[39;49;00m[90m[39;49;00m
[1m[31mE   assert False is True[0m
[31m[1m__________________ test_post_condition_event_bus_operational ___________________[0m
[1m[31mtests/runtime/test_post_conditions.py[0m:133: in test_post_condition_event_bus_operational
    [0m[94massert[39;49;00m result[[33m'[39;49;00m[33mpassed[39;49;00m[33m'[39;49;00m] [95mis[39;49;00m [94mTrue[39;49;00m[90m[39;49;00m
[1m[31mE   assert False is True[0m
[31m[1m_________________________ test_smoke_event_bus_success _________________________[0m
[1m[31mtests/runtime/test_smoke.py[0m:94: in test_smoke_event_bus_success
    [0m[94massert[39;49;00m result[[33m'[39;49;00m[33mpassed[39;49;00m[33m'[39;49;00m] [95mis[39;49;00m [94mTrue[39;49;00m[90m[39;49;00m
[1m[31mE   assert False is True[0m
[31m[1m______________________ test_smoke_state_tracking_success _______________________[0m
[1m[31mtests/runtime/test_smoke.py[0m:127: in test_smoke_state_tracking_success
    [0mdb = Database()[90m[39;49;00m
         ^^^^^^^^^^[90m[39;49;00m
[1m[31mE   TypeError: Database.__init__() missing 1 required positional argument: 'db_path'[0m
[31m[1m_____________ TestCooldownAfterLossRule.test_cooldown_starts_timer _____________[0m
[1m[31mC:\Users\jakers\Desktop\risk-manager-v34\tests\unit\test_rules\test_cooldown_after_loss.py[0m:355: in test_cooldown_starts_timer
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31msrc/risk_manager/rules/cooldown_after_loss.py[0m:267: in enforce
    [0m[94mawait[39;49;00m [96mself[39;49;00m.lockout_manager.set_cooldown([90m[39;49;00m
[1m[31mE   TypeError: object Mock can't be used in 'await' expression[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 CooldownAfterLossRule initialized: 1 tiers
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 Cooldown triggered for account ACC-001: Loss=$-150.00, Cooldown=300s

[32mINFO    [0m root:conftest.py:37 ENFORCING RULE-007: Account ACC-001 Loss: $-150.00, Cooldown: 300s
[31m[1m_______ TestCooldownAfterLossRule.test_cooldown_expires_unlocks_account ________[0m
[1m[31mC:\Users\jakers\Desktop\risk-manager-v34\tests\unit\test_rules\test_cooldown_after_loss.py[0m:382: in test_cooldown_expires_unlocks_account
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31msrc/risk_manager/rules/cooldown_after_loss.py[0m:267: in enforce
    [0m[94mawait[39;49;00m [96mself[39;49;00m.lockout_manager.set_cooldown([90m[39;49;00m
[1m[31mE   TypeError: object Mock can't be used in 'await' expression[0m
------------------------------ Captured log setup ------------------------------
[32mINFO    [0m root:conftest.py:37 CooldownAfterLossRule initialized: 1 tiers
------------------------------ Captured log call -------------------------------
[32mINFO    [0m root:conftest.py:37 ENFORCING RULE-007: Account ACC-001 Loss: $-150.00, Cooldown: 300s
[33m=============================== warnings summary ===============================[0m
.venv/lib/python3.13/site-packages/uvloop/__init__.py:154
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/.venv/lib/python3.13/site-packages/uvloop/__init__.py:154: DeprecationWarning: uvloop.install() is deprecated in favor of uvloop.run() starting with Python 3.12.
    _warnings.warn(

tests/e2e/test_max_contracts_e2e.py:80
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/e2e/test_max_contracts_e2e.py:80: PytestUnknownMarkWarning: Unknown pytest.mark.e2e - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.e2e

tests/integration/test_cooldown_after_loss_integration.py: 15 warnings
tests/integration/test_daily_realized_profit_integration.py: 15 warnings
tests/integration/test_session_block_outside_integration.py: 12 warnings
tests/integration/test_trade_frequency_limit_integration.py: 12 warnings
tests/unit/test_state/test_lockout_manager.py: 31 warnings
tests/unit/test_state/test_pnl_tracker.py: 12 warnings
tests/unit/test_state/test_reset_scheduler.py: 23 warnings
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/database.py:82: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (1, datetime.utcnow().isoformat()),

tests/integration/test_daily_realized_profit_integration.py: 34 warnings
tests/unit/test_state/test_pnl_tracker.py: 23 warnings
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/pnl_tracker.py:63: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/integration/test_daily_realized_profit_integration.py::test_reset_scheduler_integration
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerReset::test_reset_clears_daily_pnl
tests/unit/test_state/test_pnl_tracker.py::TestPnLTrackerTradeCount::test_trade_count_resets_with_pnl
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/pnl_tracker.py:194: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow().isoformat()

tests/runtime/test_post_conditions.py::test_post_condition_event_bus_operational
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/runtime/test_post_conditions.py:117: RuntimeWarning: coroutine 'EventBus.publish' was never awaited
    bus.publish(RiskEvent(event_type=EventType.TRADE_EXECUTED, data={}))
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/runtime/test_smoke.py::test_smoke_event_bus_success
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/tests/runtime/test_smoke.py:85: RuntimeWarning: coroutine 'EventBus.publish' was never awaited
    bus.publish(RiskEvent(event_type=EventType.POSITION_UPDATED, data={}))
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_auto_expires_after_duration
tests/unit/test_state/test_lockout_manager.py::TestCooldownTimers::test_cooldown_cleared_cancels_timer
  /mnt/c/Users/jakers/Desktop/risk-manager-v34/src/risk_manager/state/lockout_manager.py:394: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self.timer_manager.cancel_timer(f"lockout_{account_id}")
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m tests/integration/test_cooldown_after_loss_integration.py::[1mTestCooldownAfterLossIntegration::test_rapid_loss_sequence_only_first_triggers_timer[0m - AssertionError: assert False
[31mFAILED[0m tests/integration/test_cooldown_after_loss_integration.py::[1mTestCooldownAfterLossIntegration::test_position_closed_event_triggers_cooldown[0m - AssertionError: assert False
[31mFAILED[0m tests/integration/test_no_stop_loss_grace_integration.py::[1mTestNoStopLossGraceIntegration::test_multiple_positions_independent_timers[0m - assert 0 == 1
[31mFAILED[0m tests/integration/test_no_stop_loss_grace_integration.py::[1mTestNoStopLossGraceIntegration::test_real_async_timer_callback_execution[0m - assert 0 == 1
[31mFAILED[0m tests/integration/test_no_stop_loss_grace_integration.py::[1mTestNoStopLossGraceIntegration::test_concurrent_timer_operations[0m - assert 0 == 2
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_weekend_blocking_sunday[0m - TypeError: TestSessionBlockOutsideIntegration.test_weekend_blocking_sunday....
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_dst_spring_forward_transition[0m - TypeError: TestSessionBlockOutsideIntegration.test_dst_spring_forward_trans...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_dst_fall_back_transition[0m - TypeError: TestSessionBlockOutsideIntegration.test_dst_fall_back_transition...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_lockout_persistence_across_restarts[0m - TypeError: TestSessionBlockOutsideIntegration.test_lockout_persistence_acro...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_multi_account_independence[0m - TypeError: TestSessionBlockOutsideIntegration.test_multi_account_independen...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_event_bus_integration[0m - TypeError: TestSessionBlockOutsideIntegration.test_event_bus_integration.<l...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_database_schema_validation[0m - TypeError: TestSessionBlockOutsideIntegration.test_database_schema_validati...
[31mFAILED[0m tests/integration/test_session_block_outside_integration.py::[1mTestSessionBlockOutsideIntegration::test_different_timezone_support[0m - TypeError: TestSessionBlockOutsideIntegration.test_different_timezone_suppo...
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_auto_stop_loss_placement_mnq_short[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_auto_take_profit_placement[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_bracket_order_creation[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_trailing_stop_adjustment_on_profit[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_multi_symbol_independent_management[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_event_bus_routes_to_rule[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_stop_loss_disabled_only_take_profit[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_take_profit_disabled_only_stop_loss[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_complete_order_placement_flow[0m - assert None is not None
[31mFAILED[0m tests/integration/test_trade_management_integration.py::[1mTestTradeManagementIntegration::test_event_processing_performance[0m - assert None is not None
[31mFAILED[0m tests/runtime/test_dry_run.py::[1mtest_dry_run_pnl_calculation[0m - TypeError: Database.__init__() missing 1 required positional argument: 'db_...
[31mFAILED[0m tests/runtime/test_dry_run.py::[1mtest_dry_run_vs_real_comparison[0m - assert False is True
[31mFAILED[0m tests/runtime/test_post_conditions.py::[1mtest_post_condition_event_bus_operational[0m - assert False is True
[31mFAILED[0m tests/runtime/test_smoke.py::[1mtest_smoke_event_bus_success[0m - assert False is True
[31mFAILED[0m tests/runtime/test_smoke.py::[1mtest_smoke_state_tracking_success[0m - TypeError: Database.__init__() missing 1 required positional argument: 'db_...
[31mFAILED[0m tests/unit/test_rules/test_cooldown_after_loss.py::[1mTestCooldownAfterLossRule::test_cooldown_starts_timer[0m - TypeError: object Mock can't be used in 'await' expression
[31mFAILED[0m tests/unit/test_rules/test_cooldown_after_loss.py::[1mTestCooldownAfterLossRule::test_cooldown_expires_unlocks_account[0m - TypeError: object Mock can't be used in 'await' expression
[31m=========== [31m[1m30 failed[0m, [32m513 passed[0m, [33m186 warnings[0m[31m in 187.75s (0:03:07)[0m[31m ===========[0m


================================================================================
End of Report
================================================================================
