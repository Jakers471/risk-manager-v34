================================================================================
RULES ALIGNMENT AUDIT - VISUAL MATRIX
================================================================================
Generated: 2025-10-27
Mission: Audit ALL 13 rule specifications against SDK event patterns

================================================================================
OVERALL ALIGNMENT STATUS: 82% (10.5/13 rules aligned)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rule    â”‚ Name                        â”‚ Status     â”‚ Issues Found              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-001â”‚ Max Contracts               â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-002â”‚ Max Contracts Per Instr     â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-003â”‚ Daily Realized Loss         â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-004â”‚ Daily Unrealized Loss       â”‚ âš ï¸  PARTIAL â”‚ Event docs + field name   â”‚
â”‚ RULE-005â”‚ Max Unrealized Profit       â”‚ âš ï¸  PARTIAL â”‚ Event docs + field name   â”‚
â”‚ RULE-006â”‚ Trade Frequency Limit       â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-007â”‚ Cooldown After Loss         â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-008â”‚ No Stop-Loss Grace          â”‚ ğŸ”´ BROKEN  â”‚ CRITICAL: Wrong event     â”‚
â”‚ RULE-009â”‚ Session Block Outside       â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-010â”‚ Auth Loss Guard             â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-011â”‚ Symbol Blocks               â”‚ âœ… ALIGNED â”‚ None                      â”‚
â”‚ RULE-012â”‚ Trade Management            â”‚ âš ï¸  UNCLEAR â”‚ Missing QUOTE_UPDATE ref  â”‚
â”‚ RULE-013â”‚ Daily Realized Profit       â”‚ âœ… ALIGNED â”‚ None                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
  âœ… = Fully aligned with SDK patterns
  âš ï¸  = Partially aligned (minor issues)
  ğŸ”´ = Not aligned (critical issues)

================================================================================
DETAILED ALIGNMENT BREAKDOWN
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Subscription Patterns                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rule    â”‚ Events Used                                   â”‚ Correctness      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-001â”‚ POSITION_OPENED, UPDATED, CLOSED              â”‚ âœ… Correct       â”‚
â”‚ RULE-002â”‚ POSITION_OPENED, UPDATED, CLOSED              â”‚ âœ… Correct       â”‚
â”‚ RULE-003â”‚ TRADE_EXECUTED                                â”‚ âœ… Correct       â”‚
â”‚ RULE-004â”‚ POSITION_OPENED, UPDATED, CLOSED + QUOTE      â”‚ âš ï¸  Inconsistent â”‚
â”‚ RULE-005â”‚ POSITION_OPENED, UPDATED, CLOSED + QUOTE      â”‚ âš ï¸  Inconsistent â”‚
â”‚ RULE-006â”‚ TRADE_EXECUTED                                â”‚ âœ… Correct       â”‚
â”‚ RULE-007â”‚ TRADE_EXECUTED (profitAndLoss < 0)           â”‚ âœ… Correct       â”‚
â”‚ RULE-008â”‚ ORDER_PLACED                                  â”‚ ğŸ”´ WRONG!        â”‚
â”‚ RULE-009â”‚ POSITION_UPDATED + timer + holiday            â”‚ âœ… Correct       â”‚
â”‚ RULE-010â”‚ ACCOUNT_UPDATED (canTrade)                    â”‚ âœ… Correct       â”‚
â”‚ RULE-011â”‚ POSITION_OPENED, UPDATED, CLOSED              â”‚ âœ… Correct       â”‚
â”‚ RULE-012â”‚ POSITION events + "market price updates"      â”‚ âš ï¸  Unclear      â”‚
â”‚ RULE-013â”‚ TRADE_EXECUTED                                â”‚ âœ… Correct       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data Field References                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rule    â”‚ Fields Referenced                             â”‚ Correctness      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-001â”‚ position['type'], position['size']            â”‚ âœ… Correct       â”‚
â”‚ RULE-002â”‚ position['contractId'], position['size']      â”‚ âœ… Correct       â”‚
â”‚ RULE-003â”‚ trade_event['profitAndLoss']                  â”‚ âœ… Correct       â”‚
â”‚ RULE-004â”‚ position_event['avgPrice'] â† WRONG NAME!      â”‚ âš ï¸  Wrong name   â”‚
â”‚ RULE-005â”‚ position_event['avgPrice'] â† WRONG NAME!      â”‚ âš ï¸  Wrong name   â”‚
â”‚ RULE-006â”‚ (counts trades, no specific fields)           â”‚ âœ… Correct       â”‚
â”‚ RULE-007â”‚ trade_event['profitAndLoss'] < 0              â”‚ âœ… Correct       â”‚
â”‚ RULE-008â”‚ (no field references - MISSING!)              â”‚ ğŸ”´ Missing       â”‚
â”‚ RULE-009â”‚ (time-based, no event fields)                 â”‚ âœ… Correct       â”‚
â”‚ RULE-010â”‚ account_event['canTrade']                     â”‚ âœ… Correct       â”‚
â”‚ RULE-011â”‚ position['contractId']                        â”‚ âœ… Correct       â”‚
â”‚ RULE-012â”‚ (no field references - MISSING!)              â”‚ âš ï¸  Missing      â”‚
â”‚ RULE-013â”‚ trade_event['profitAndLoss']                  â”‚ âœ… Correct       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Event Semantic Accuracy                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rule    â”‚ Semantic Correctness                          â”‚ Status           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-001â”‚ Position events for position tracking         â”‚ âœ… Correct       â”‚
â”‚ RULE-002â”‚ Position events for position tracking         â”‚ âœ… Correct       â”‚
â”‚ RULE-003â”‚ TRADE_EXECUTED has profitAndLoss             â”‚ âœ… Correct       â”‚
â”‚ RULE-004â”‚ POSITION + QUOTE for unrealized P&L          â”‚ âœ… Correct       â”‚
â”‚ RULE-005â”‚ POSITION + QUOTE for unrealized P&L          â”‚ âœ… Correct       â”‚
â”‚ RULE-006â”‚ TRADE_EXECUTED for trade counting            â”‚ âœ… Correct       â”‚
â”‚ RULE-007â”‚ TRADE_EXECUTED for realized loss             â”‚ âœ… Correct       â”‚
â”‚ RULE-008â”‚ ORDER_PLACED â‰  position opens!               â”‚ ğŸ”´ WRONG!        â”‚
â”‚ RULE-009â”‚ POSITION_UPDATED + timer for session          â”‚ âœ… Correct       â”‚
â”‚ RULE-010â”‚ ACCOUNT_UPDATED for authorization            â”‚ âœ… Correct       â”‚
â”‚ RULE-011â”‚ Position events for symbol blocking           â”‚ âœ… Correct       â”‚
â”‚ RULE-012â”‚ POSITION + price for trade management        â”‚ âš ï¸  Unclear      â”‚
â”‚ RULE-013â”‚ TRADE_EXECUTED for realized profit           â”‚ âœ… Correct       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
SEVERITY BREAKDOWN
================================================================================

ğŸ”´ CRITICAL Issues (1):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rule    â”‚ Issue                â”‚ Impact                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-008â”‚ Wrong event type     â”‚ Will trigger on EVERY order (entry, stop,  â”‚
â”‚         â”‚                      â”‚ limit) instead of just position opens.     â”‚
â”‚         â”‚                      â”‚ Completely broken semantics.               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  MEDIUM Issues (2 rules, 4 total issues):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rule    â”‚ Issue                â”‚ Impact                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-004â”‚ Inconsistent event   â”‚ Documentation confusion - line 17 says 3   â”‚
â”‚         â”‚ subscription docs    â”‚ events, line 124 says 1 event.             â”‚
â”‚ RULE-004â”‚ Wrong field name     â”‚ Code will fail - SDK uses 'averagePrice'   â”‚
â”‚         â”‚                      â”‚ not 'avgPrice'                             â”‚
â”‚ RULE-005â”‚ Inconsistent event   â”‚ Documentation confusion - line 17 says 3   â”‚
â”‚         â”‚ subscription docs    â”‚ events, line 125 says 1 event.             â”‚
â”‚ RULE-005â”‚ Wrong field name     â”‚ Code will fail - SDK uses 'averagePrice'   â”‚
â”‚         â”‚                      â”‚ not 'avgPrice'                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  LOW Issues (1):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rule    â”‚ Issue                â”‚ Impact                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RULE-012â”‚ Missing QUOTE_UPDATE â”‚ Documentation unclear - mentions "market   â”‚
â”‚         â”‚ event reference      â”‚ price updates" but doesn't name the event. â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
PATTERN CONSISTENCY ANALYSIS
================================================================================

âœ… CORRECT PATTERNS (Used Consistently):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pattern: Position Tracking (All 3 events)                                   â”‚
â”‚   - POSITION_OPENED, POSITION_UPDATED, POSITION_CLOSED                      â”‚
â”‚   - Used by: RULE-001, 002, 011 âœ…                                          â”‚
â”‚   - Partially used by: RULE-004, 005 (line 17 âœ…, line 124/125 âŒ)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pattern: Realized P&L (TRADE_EXECUTED + null check)                        â”‚
â”‚   - TRADE_EXECUTED.profitAndLoss (skip if null)                            â”‚
â”‚   - Used by: RULE-003, 013 âœ…                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pattern: Trade Counting (TRADE_EXECUTED)                                   â”‚
â”‚   - Count TRADE_EXECUTED events                                            â”‚
â”‚   - Used by: RULE-006, 007 âœ…                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pattern: Authorization Check (ACCOUNT_UPDATED)                             â”‚
â”‚   - ACCOUNT_UPDATED.canTrade field                                         â”‚
â”‚   - Used by: RULE-010 âœ…                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸  INCONSISTENT PATTERNS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Issue: RULE-004/005 event subscription documentation                        â”‚
â”‚   - Line 17 (Trigger Condition): Lists all 3 position events âœ…             â”‚
â”‚   - Line 124/125 (SDK Integration): Only lists POSITION_UPDATED âŒ          â”‚
â”‚   - Fix: Update SDK Integration sections to match Trigger Condition        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Issue: RULE-004/005 field naming                                           â”‚
â”‚   - Spec uses: position_event['avgPrice'] âŒ                                â”‚
â”‚   - SDK uses: position_event['averagePrice'] âœ…                             â”‚
â”‚   - Fix: Change field name to match SDK exactly                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”´ MISSING PATTERNS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Issue: RULE-008 stop-loss detection pattern completely missing              â”‚
â”‚   - Currently: Subscribes to ORDER_PLACED (WRONG!)                         â”‚
â”‚   - Should use:                                                             â”‚
â”‚     1. POSITION_OPENED â†’ detect when position opens                        â”‚
â”‚     2. ORDER_PLACED (order.type == 3) â†’ detect stop-loss orders           â”‚
â”‚     3. Match contractId to link stop-loss to position                      â”‚
â”‚   - Fix: Complete rewrite of trigger condition logic                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
FILES REQUIRING UPDATES
================================================================================

ğŸ”´ CRITICAL:
  - docs/specifications/unified/rules/RULE-008-no-stop-loss-grace.md
    Lines: 14-17 (Trigger Condition), 35 (SDK Integration)

âš ï¸  MEDIUM:
  - docs/specifications/unified/rules/RULE-004-daily-unrealized-loss.md
    Lines: 24 (field name), 124 (event list)
  - docs/specifications/unified/rules/RULE-005-max-unrealized-profit.md
    Lines: 24 (field name), 125 (event list)

âš ï¸  LOW:
  - docs/specifications/unified/rules/RULE-012-trade-management.md
    Lines: 17 (Trigger Condition), 44-45 (SDK Integration)

================================================================================
NEXT ACTIONS
================================================================================

Priority 1 - CRITICAL (Do Immediately):
  [ ] Fix RULE-008 event subscription logic
  [ ] Add POSITION_OPENED to detect position opens
  [ ] Add ORDER_PLACED logic to detect stop-loss orders
  [ ] Document order.type == 3 check for stop detection

Priority 2 - MEDIUM (Do Soon):
  [ ] Fix RULE-004 line 124 (add all 3 position events)
  [ ] Fix RULE-004 line 24 (avgPrice â†’ averagePrice)
  [ ] Fix RULE-005 line 125 (add all 3 position events)
  [ ] Fix RULE-005 line 24 (avgPrice â†’ averagePrice)

Priority 3 - LOW (Do Before Implementation):
  [ ] Fix RULE-012 line 17 (add explicit QUOTE_UPDATE)
  [ ] Fix RULE-012 lines 44-45 (add data field references)

================================================================================
VALIDATION CHECKLIST
================================================================================

Before marking any rule as "aligned", verify:
  [ ] Event types listed match SDK event types exactly
  [ ] Data fields referenced exist in those events
  [ ] Event subscriptions are consistent across all sections
  [ ] Field names match SDK naming (e.g., 'averagePrice' not 'avgPrice')
  [ ] Event semantics are correct (ORDER_PLACED â‰  position opens!)
  [ ] All 3 position events used when tracking positions
  [ ] Null checks present for profitAndLoss field

================================================================================
REFERENCE DOCUMENTS
================================================================================

  - SDK Event Patterns: SDK_EVENTS_QUICK_REFERENCE.txt
  - Full Audit Report: RULES_ALIGNMENT_AUDIT_REPORT.md
  - Quick Summary: AUDIT_SUMMARY.md
  - Rule Specifications: docs/specifications/unified/rules/RULE-*.md

================================================================================
END OF ALIGNMENT MATRIX
================================================================================
